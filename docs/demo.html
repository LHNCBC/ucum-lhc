<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
     integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
     crossorigin="anonymous" />
        <meta charset="utf-8">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-59GQ6JK');</script>
    <!-- End Google Tag Manager -->

    <style id="antiClickjack">
      body{display:none !important;}
    </style>
    <script type="text/javascript">
      if (self === top) {
        var antiClickjack = document.getElementById("antiClickjack");
        antiClickjack.parentNode.removeChild(antiClickjack);
      } else {
        top.location = self.location;
      }
    </script>
    <link href="//fonts.googleapis.com/css?family=Droid+Sans:400,700"
     rel="stylesheet" type="text/css">
    <link href="ucumDemo.min.css" rel="stylesheet"/>

    <link rel="canonical" href="https://ucum.nlm.nih.gov/ucum-lhc/demo.html" />
    <title>UCUM-LHC Demo</title>
    <meta name="description" content="Unified Code of Units of Measure (UCUM) LHC unit code validator and conversion calculator">
    <meta name="keywords" content="UCUM,LHC,Unit Codes,Units of Measure">
    <link rel="stylesheet"
     href="https://clinicaltables.nlm.nih.gov/autocomplete-lhc-versions/18.1.1/autocomplete-lhc.min.css"
     integrity="sha384-JjNQGLGKwnlylBNqm5Al8cA7jt1nF5dHsagzjEEE85ZHogKi96zVUB2wehoMQAZ9"
     crossorigin="anonymous" />
  </head>
  <body id="demobody" onhashchange="demoPkg.UcumDemo.getInstance().checkTabSwitch();"
        onload="demoPkg.UcumDemo.getInstance().buildAdvancedSettings();" >

        <!-- Google Tag Manager (noscript) -->
    <noscript><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-59GQ6JK"
        height="0" width="0" style="display:none;visibility:hidden"
        title="googletagmanager" sandbox></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- page header -->
    <div id="sharedHeader"></div>
    <div id="header">
      <a href="https://lhcforms.nlm.nih.gov" title="LHC FHIR Tools" id="logo">
        <img src="assets/images/projectLogo.svg" alt="LHC FHIR Tools" />
      </a>
      <div id="siteNameBox">
        <a href="index.html"><span id=siteName>UCUM-LHC</span><br>
          <span id=tagline>A Unified Code for Units of Measure Software Library
            from the National Library of Medicine</span></a>
      </div>
    </div> <!-- end page header -->


    <div id="content">

      <!-- links to other ucum pages -->
      <div>
        <a href="https://ucum.nlm.nih.gov">UCUM Resources</a>&nbsp; &nbsp;
        <a href="index.html">UCUM-LHC Overview</a>
      </div>
      <!-- end links to other ucum pages -->
      <h1>The UCUM-LHC Validator and Converter</h1>

      <!-- navigator/converter tabs -->
      <ul class="tab nav nav-tabs">
        <li class="active">
            <a id="validation-link" href="#validation" class="tablinks"
               data-toggle="tab"
               onclick="demoPkg.UcumDemo.getInstance().showValidateTab()">
               Validator</a></li>
        <li>
            <a id="conversion-link" href="#conversion" class="tablinks"
               data-toggle="tab"
               onclick="demoPkg.UcumDemo.getInstance().showConvertTab()">
               Converter</a></li>
      </ul>

      <!-- Converter tab -->
      <div class="tab-content">
        <div id="conversion" class="tabcontent tab-pane fade">
          <h2>UCUM Unit Conversions</h2>
          <div id="convSection" class="section">

            <p id="convMsg" class="errMsg"> </p>
            <p id="convSuggestions"> </p>
            <div class="inner-section">
              <div class="flex-container outer-container">
                <div class="flex-container inner-container"><!-- left side -->
                  <div>
                    <input type="text" id="convertFromNum"
                      class="input-field input-number"
                           aria-label="left number"
                      onchange=
                      "demoPkg.UcumDemo.getInstance().checkNumVal('convertFromNum')">
                  </div>
                  <!-- input field to receive UCUM expression.  Callback to handle
                       user's input is defined with the definition of the
                       autocompleter for this field, in the demo.js constructor -->
                    <div>
                    <span class="input-field">
                      <input type="text" id="convertFrom" class="input-field"
                             aria-label="left unit"
                        placeholder="Enter UCUM code ...">
                    </span>
                    <div id="convertFromName" class="unit-name" wrap="soft"></div>
                  </div>


                </div> <!-- left inner container -->
                <div class="flex-container middle-column">
                  <div>=</div>
                </div>
                <div class="flex-container inner-container"><!-- right side -->
                  <div>
                    <input type="text" id="convertToNum"
                      class="input-field input-number"
                           aria-label="right number"
                      onchange=
                      "demoPkg.UcumDemo.getInstance().checkNumVal('convertToNum')">
                  </div>
                  <!-- input field to receive UCUM expression.  Callback to handle
                       user's input is defined with the definition of the
                       autocompleter for this field, in the demo.js constructor -->
                  <div>
                    <span class="input-field">
                      <input type="text" id="convertTo" class="input-field"
                             aria-label="right unit"
                        placeholder="Enter UCUM code ...">
                    </span>
                    <div id="convertToName" class="unit-name" wrap="soft"></div>
                  </div>
                  <!-- we don't seem to be using the precision-line at the moment
                       but leaving it here is required for the precision code
                       left in demo.js.  #precision-line in the css file is set
                       to display: hidden-->
                  <div id="precision-line">
                    <input type="number" min="0" max="20" id="precision"
                           onchange="demoPkg.UcumDemo.getInstance().updatePrecision('convMsg')">
                        decimal digits.
                  </div>

                </div><!-- right inner container -->

              </div> <!-- outer-container -->
              <div id="molecular-weight">
                <label>
                  Molecular weight of the substance being converted: &nbsp;
                  <input type="text" id="moleWeight"
                       onchange="demoPkg.UcumDemo.getInstance().checkNumVal('moleWeight')">
                </label>
              </div>
              <div id="charge-div">
                <label>
                  Charge/valence of the substance being converted (as a positive integer): &nbsp;
                  <input type="text" id="charge"
                       onchange="demoPkg.UcumDemo.getInstance().checkNumVal('charge')">
                </label>
              </div>
              <a id="advSearchOpts"
                    tabindex="0"
                    onclick="demoPkg.UcumDemo.getInstance().toggleDisplay(
                                'advancedSearchCnv','toggleAdvancedSearchCnvB',
                                'Hide', 'Show', 'advanced options')">advanced options</a>
              <div id="advancedSearchCnv" style="display: none">
                <!-- this section is built in the demo code when the page is loaded -->
              </div> <!-- advancedSearchCnv division -->
            </div><!-- inner-section -->
            <!---  Not using this list for now
            onblur="demoPkg.UcumDemo.getInstance().getCommensurables('convertFrom',
                                                                     'convertTo',
                                                                     'resultString')">
            -->
            <ul>
              <li> UCUM codes are <b>case-sensitive</b>.</li>
              <li> You can enter other commensurate units that are not on the
                  UCUM Code lists.</li>
              <li><a id="toggleCnvHints"
                        tabindex="0"
                        onclick="
                  demoPkg.UcumDemo.getInstance().toggleDisplay('cnvHints',
                                                               'toggleCnvHints',
                                                               'Hide', 'Show', ' syntax rules')">
              syntax rules</a>
              </li>
            </ul>
            <div id="cnvHints" class="limitWidth" style="display: none">
              <br>
<h4 style="text-align: left">Unit Expression Syntax Rules</h4>
<p class="small-print">See the <a href="http://unitsofmeasure.org/ucum.html">
    UCUM Specification</a> for full descriptions of grammar and syntax rules.
<ul class="small-print">
    <li>A <a href="http://unitsofmeasure.org/ucum.html#section-Prefixes">UCUM
        defined prefix</a> can be applied to metric units, e.g. kg for
        kilogram (where k is the prefix kilo and g is the base unit gram).</li>
    <li>Simple units may be <a href="http://unitsofmeasure.org/ucum.html#para-9">
        raised to a power</a> by appending an integer number to the end of the
        unit term, e.g., m2 for a square meter.  Negative exponents must be
        preceded by a minus sign ('-').  Positive exponents may be preceded by
        a plus sign ('+') although the sign may be omitted.</li>
    <li>All units can be combined in an <a href="http://unitsofmeasure.org/ucum.html#para-7">
        algebraic term</a> using the operators for multiplication (period '.')
        and division (solidus '/'), e.g., 2.m.</li>
    <li>No blanks are allowed within the unit expression.</li>
    <li>Multiple terms in an expression must be separated by an arithmetic
        operator - either the multiplication operator (.) or the division
        operator (/), e.g., 2.m, not 2m.</li>
    <li>The multiplication operator (.) must be explicity specified; it is never
        assumed.</li>
    <li>While the multiplication operator (.) must appear between two unit terms,
        the division operator (/) may appear at the beginning of the expression,
        indicating inversion of the following term.  So /dL is a valid unit
        indicating "per deciliter".  However, the division
        operator normally appears between two terms.</li>
    <li>Terms are evaluated from left to right, with multiplication and
        division having the same precedence.</li>
    <li><a href="http://unitsofmeasure.org/ucum.html#para-10">Parentheses</a>
        may be used to override normal left-to-right evaluation
        of an expreession.  For example kg/m.s2 divides kg by m and multiplies
        the result by s2.   kg/(m.s2) divides kg by the result of multiplying
        m by s2.</li>
</ul>
            </div><!-- hints div -->
            <p class="small-print">Disclaimer:  &nbsp;Conversion results are for
              demonstration purposes only.  Before relying on the unit conversions
              produced by this tool it is your obligation to perform your own tests
              to verify that the results are sufficiently accurate for your purposes.
            </p>
          </div> <!-- end convSection div -->
        </div> <!-- end Converter tab -->

        <!-- Validator tab -->
        <div id="validation" class="tabcontent tab-pane fade in active">
          <h2>UCUM Unit Expression Validation</h2>
          <div id="singleString" class="section">
            <h3>Validate unit expressions one at a time</h3>
              <!-- input field to receive UCUM expression.  Callback to handle
                   user's input is defined with the definition of the
                   autocompleter for this field, in the demo.js constructor -->
              <div class="flex-container" id="valStringDiv">
                <div>
                  <input type="text" id="valString" placeholder="Enter UCUM expression ...">&nbsp; &nbsp;
                </div>
                <div id="validationString">&nbsp;&nbsp;</div>
              </div> <!-- valStringDiv -->
            <div id="valButtonLinks">
            <a id="advValSearchOpts"
                  tabindex="0"
                    onclick="demoPkg.UcumDemo.getInstance().toggleDisplay(
                                  'advancedSearchVal','toggleAdvancedSearchValB',
                                  'Hide', 'Show', 'advanced options')">advanced options</a>
            <a id="toggleValHints"
                  tabindex="0"
                    onclick="
                    demoPkg.UcumDemo.getInstance().toggleDisplay('valHints',
                                                                 'toggleValHints',
                                                                 'Hide', 'Show', 'syntax rules')">
                    syntax rules</a>
            </div>
            <div id="advancedSearchVal" style="display: none">
              <!-- this section is built in the demo code when the page is loaded -->
            </div> <!-- advancedSearchCnv division -->

            <div id="valHints" class="limitWidth" style="display: none">
              <br>
<h4 style="text-align: left">Unit Expression Syntax Rules</h4>
<p class="small-print">See the <a href="http://unitsofmeasure.org/ucum.html">
    UCUM Specification</a> for full descriptions of grammar and syntax rules.
<ul class="small-print">
    <li>A <a href="http://unitsofmeasure.org/ucum.html#section-Prefixes">UCUM
        defined prefix</a> can be applied to metric units, e.g. kg for
        kilogram (where k is the prefix kilo and g is the base unit gram).</li>
    <li>Simple units may be <a href="http://unitsofmeasure.org/ucum.html#para-9">
        raised to a power</a> by appending an integer number to the end of the
        unit term, e.g., m2 for a square meter.  Negative exponents must be
        preceded by a minus sign ('-').  Positive exponents may be preceded by
        a plus sign ('+') although the sign may be omitted.</li>
    <li>All units can be combined in an <a href="http://unitsofmeasure.org/ucum.html#para-7">
        algebraic term</a> using the operators for multiplication (period '.')
        and division (solidus '/'), e.g., 2.m.</li>
    <li>No blanks are allowed within the unit expression.</li>
    <li>Multiple terms in an expression must be separated by an arithmetic
        operator - either the multiplication operator (.) or the division
        operator (/), e.g., 2.m, not 2m.</li>
    <li>The multiplication operator (.) must be explicity specified; it is never
        assumed.</li>
    <li>While the multiplication operator (.) must appear between two unit terms,
        the division operator (/) may appear at the beginning of the expression,
        indicating inversion of the following term.  So /dL is a valid unit
        indicating "per deciliter".  However, the division
        operator normally appears between two terms.</li>
    <li>Terms are evaluated from left to right, with multiplication and
        division having the same precedence.</li>
    <li><a href="http://unitsofmeasure.org/ucum.html#para-10">Parentheses</a>
        may be used to override normal left-to-right evaluation
        of an expreession.  For example kg/m.s2 divides kg by m and multiplies
        the result by s2.   kg/(m.s2) divides kg by the result of multiplying
        m by s2.</li>
</ul>
            </div><!-- hints div -->
          </div><!-- singleString div -->
          <div id="filevalidation" class="section">
            <h3>Validate all unit expressions in a CSV file</h3>
            <p>We can validate unit expressions in a <b>c</b>omma <b>s</b>eparated
              <b>v</b>alues file on your system.
            <ul>
              <li>Use the browse button below to select the file.</li>
              <li>Your file must meet the following requirements:
                <ul>
                  <li>a comma is used to separate values;</li>
                  <li>the first row must be column headers;</li>
                  <li>if the value in the cell contains commas, double quotes
                    or newlines characters, you will need to enclose the value in double
                    quotes and where you want to use double quotes, repeat them twice.<br>
                    (Example: A cell value of <code>Say "Hi"</code> would become <code>"Say ""Hi"""</code>.)
                  </li>
                </ul>
              </li>
              <li>You will then be asked for the name of the column that contains
                the expressions to be validated.
              </li>
              <li>A copy of your file will be created that includes three
                additional columns at the end, confirming what expression was
                validated, the validation results, and any relevant notes.
              </li>
              <li>You will be asked where you want the file saved.  You may
                change the name of the output file at that time.
              </li>
              <li>Note that this will only validate <b>unit</b> expressions.
                Although prefixes used with a unit code, e.g., "kL" (kiloliter),
                are recognized as prefixes ("k" for kilo) modifying a unit code
                ("L" for liter), a prefix submitted by itself, e.g., "E" (exa)
                will result in an "invalid unit code" return.
              </li>
            </ul>
            <input type="file" id="inputfile"
                onchange="demoPkg.UcumDemo.getInstance().fileSelected()">
            <div id="colNameDiv" style="display:none">
              Name of the column that contains the expressions to be validated
              <input type="text" id="colName">&nbsp; &nbsp;
              <button id="startValidation"
                onclick="demoPkg.UcumDemo.getInstance().columnSpecified()"
                type="button">Validate File</button>
              <button id="cancelValidation"
                onclick="demoPkg.UcumDemo.getInstance().resetFileInput()"
                type="button">Cancel</button>
            </div><!-- colNameDiv -->
            <!-- <a id="downlink" href="" style="'display:none'"></a> -->
          </div><!-- filevalidation div -->
          <div id="aboutSection" class="section">
            <h3>About the UCUM-LHC Library</h3>
            <ul>
              <li>Here is a <a href="index.html">description</a> of the UCUM-LHC
                Software Library.
              </li>
              <li>The code is available from the
                <a href="https://github.com/lhncbc/ucum-lhc">GitHub code repository</a>.
              </li>
              <li>The UCUM-LHC code uses unit definitions from the
                <a href="http://unitsofmeasure.org">Unified Code for Units Of
                Measure</a>
                <a href="http://unitsofmeasure.org/ucum-essence.xml">ucum-essence.xml</a>
                file, version 2.1, revision 442, dated 2017-11-21 19:04:52 -0500 (Tue, 21 Nov 2017), with
                <a href="UcumEssenceModifications.html">minor content changes.</a>
              </li>
              <li>The ucum-essence.xml file has also been extended with commonly used
                combinations of UCUM units found in <a href="https://loinc.org">LOINC</a>,
                and LOINC properties have been added to UCUM records.
              </li>
            </ul>
          </div> <!-- end aboutSection div -->
        </div> <!-- end validator tab -->
      </div> <!-- end tab-content div -->
    </div> <!-- content -->

    <div id="sharedFooter"></div>
<script src="https://clinicaltables.nlm.nih.gov/shared/loadShared.min.js"></script>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
     integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
     crossorigin="anonymous"></script>
    <script src="https://clinicaltables.nlm.nih.gov/autocomplete-lhc-versions/18.1.1/autocomplete-lhc.min.js"
     integrity="sha384-y5lNC4qz9o7wG9yIIQQNcxxqEkWqnPit6/VnEJ9jag/gFgocblckjXdkE4NWh+0U"
     crossorigin="anonymous"></script>
    <script src="./ucum-demo.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
     integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
     crossorigin="anonymous"></script>
    <script>
      const advSearchOpts = document.getElementById('advSearchOpts');
      advSearchOpts.addEventListener('keydown', (event) => {
        if (event.key === ' ' || event.key === 'Spacebar') {
          // Prevent default SPACE behavior of scrolling.
          event.preventDefault();
          demoPkg.UcumDemo.getInstance().toggleDisplay(
                  'advancedSearchCnv','toggleAdvancedSearchCnvB',
                  'Hide', 'Show', 'advanced options');
        }
      });
      const toggleCnvHints = document.getElementById('toggleCnvHints');
      toggleCnvHints.addEventListener('keydown', (event) => {
        if (event.key === ' ' || event.key === 'Spacebar') {
          // Prevent default SPACE behavior of scrolling.
          event.preventDefault();
          demoPkg.UcumDemo.getInstance().toggleDisplay('cnvHints',
                  'toggleCnvHints',
                  'Hide', 'Show', 'syntax rules');
        }
      });
      const advValSearchOpts = document.getElementById('advValSearchOpts');
      advValSearchOpts.addEventListener('keydown', (event) => {
        if (event.key === ' ' || event.key === 'Spacebar') {
          // Prevent default SPACE behavior of scrolling.
          event.preventDefault();
          demoPkg.UcumDemo.getInstance().toggleDisplay(
                  'advancedSearchVal','toggleAdvancedSearchValB',
                  'Hide', 'Show', 'advanced options');
        }
      });
      const toggleValHints = document.getElementById('toggleValHints');
      toggleValHints.addEventListener('keydown', (event) => {
        if (event.key === ' ' || event.key === 'Spacebar') {
          // Prevent default SPACE behavior of scrolling.
          event.preventDefault();
          demoPkg.UcumDemo.getInstance().toggleDisplay('valHints',
                  'toggleValHints',
                  'Hide', 'Show', 'syntax rules');
        }
      });
      function getNextFocusableElement(element) {
        const focusableElements = 'input, [tabindex]:not([tabindex="-1"])';
        const allFocusable = Array.from(document.querySelectorAll(focusableElements));
        const currentIndex = allFocusable.indexOf(element);
        for (let i = currentIndex + 1; i < allFocusable.length; i++) {
          const element = allFocusable[i];
          if (element.offsetParent !== null) { // Check if element is visible
            return element;
          }
        }
      }
      const convertFrom = document.getElementById('convertFrom');
      convertFrom.addEventListener('keydown', (event) => {
        if (event.key === 'Tab') {
          event.preventDefault();
          setTimeout(() => {
            if (demoPkg.UcumDemo.getInstance().newFieldCreated_) {
              demoPkg.UcumDemo.getInstance().newFieldCreated_ = false;
            } else {
              // Restore default behavior of TAB key, if no new fields were created.
              const nextElement = getNextFocusableElement(document.activeElement);
              nextElement?.focus();
            }
          }, 100);
        }
      });
      const convertTo = document.getElementById('convertTo');
      convertTo.addEventListener('keydown', (event) => {
        if (event.key === 'Tab') {
          event.preventDefault();
          setTimeout(() => {
            if (demoPkg.UcumDemo.getInstance().newFieldCreated_) {
              demoPkg.UcumDemo.getInstance().newFieldCreated_ = false;
            } else {
              const nextElement = getNextFocusableElement(document.activeElement);
              nextElement?.focus();
            }
          }, 100);
        }
      });
    </script>

    <!--An invisible element for announcing stuff with the screen reader.-->
    <div id="liveRegion" aria-live="assertive" aria-atomic="true" style="position: absolute; left: -1000px;"></div>
  </body>
</html>
