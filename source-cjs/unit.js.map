{"version":3,"file":"unit.js","names":["_ucumFunctions","_interopRequireDefault","require","intUtils_","_interopRequireWildcard","_getRequireWildcardCache","WeakMap","cache","obj","__esModule","default","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","Ucum","Dimension","UnitTables","isInteger","Unit","constructor","attrs","isBase_","name_","csCode_","ciCode_","property_","magnitude_","undefined","dim_","Array","printSymbol_","class_","isMetric_","variable_","cnv_","cnvPfx_","isSpecial_","isArbitrary_","moleExp_","equivalentExp_","synonyms_","source_","loincProperty_","category_","guidance_","csUnitString_","ciUnitString_","baseFactorStr_","baseFactor_","defError_","assignUnity","assignZero","assignVals","vals","uKey","charAt","length","Error","clone","retUnit","getOwnPropertyNames","forEach","val","assign","unit2","equals","fullEquals","thisAttr","keys","sort","u2Attr","keyLen","match","k","getProperty","propertyName","uProp","convertFrom","num","fromUnit","newNum","isMolMassCommensurable","needMoleWeightMsg_","isNull","fromCnv","fromMag","x","fromFunc","funcs","forName","cnvFrom","toFunc","cnvTo","convertTo","toUnit","convertCoherent","f_from","mutateCoherent","i","max","getMax","elem","getElementAt","tabs","_getUnitTables","uA","getUnitsByDimension","name","convertMolMass","amt","molecularWeight","molPowersToConvert","avoNum","getUnitByCode","moleUnitFactor","Math","pow","convertEqMass","charge","massPowersToConvert","equivalentMass","avogadroNumber","equivalents","moleFactor","adjustedEquivalents","convertEqMolMass","eqPowersToConvert","molAmt","d","getMassDimensionIndex","isEquivalentUnit","isMolarUnit","convertEqMol","mutateRatio","multiplyThis","s","mulVal","toString","_concatStrs","multiplyThese","isZero","dimVec_","add","resetFieldsForDerivedUnit","divide","invertString","sub","minus","invert","theString","stringRep","replace","substr","str1","operator","str2","startChar","endChar","_buildOneString","str","ret","isNumericString","endsWith","test","power","p","uStr","uArray","arLen","un","nun","parseInt","uLen","u","uChar","exp","join","mul","unit1Dim","setElementAt","unit2Dim","isEqMassCommensurable","isEqMolCommensurable","unit1Sum","unit2Sum","isEqMolMassCommensurable","getInstance","exports"],"sources":["../source/unit.js"],"sourcesContent":["\n/**\n * This class represents one unit of measure.  It includes\n * functions to cover constructor, accessor, and assignment tasks as\n * well as operators to calculate multiplication, division and raising\n * to a power.\n *\n * @author Lee Mericle, based on java version by Gunther Schadow\n *\n */\nvar Ucum = require('./config.js').Ucum;\nvar Dimension = require('./dimension.js').Dimension;\nimport funcs from \"./ucumFunctions.js\";\nvar UnitTables;\n\nvar isInteger = require(\"is-integer\");\nimport * as intUtils_ from \"./ucumInternalUtils.js\";\n\nexport class Unit {\n\n  /**\n   * Constructor.\n   *\n   * @param attrs an optional parameter that may be:\n   *  a string, which is parsed by the unit parser, which creates\n   *  the unit from the parsed string; or\n   *  a hash containing all or some values for the attributes of\n   *  the unit, where the keys are the attribute names, without a\n   *  trailing underscore, e.g., name instead of name_; or\n   *  null, in which case an empty hash is created and used to\n   *  set the values forthe attributes.\n   *  If a hash (empty or not) is used, attributes for which no value\n   *  is specified are assigned a default value.\n   *\n   */\n  constructor(attrs = {}) {\n\n    // Process the attrs hash passed in, which may be empty.\n    // Create and assign values (from the attrs hash or defaults) to all\n    // attributes.  From Class Declarations in Understanding ECMAScript,\n    // https://leanpub.com/understandinges6/read/#leanpub-auto-class-declarations,\n    //   \"Own properties, properties that occur on the instance rather than the\n    //    prototype, can only be created inside of a class constructor or method.\n    //    It's recommended to create all possible own properties inside of the\n    //    constructor function so there's a single place that's responsible for\n    //    all of them.\"\n\n    /*\n     * Flag indicating whether or not this is a base unit\n     */\n    this.isBase_ = attrs['isBase_'] || false ;\n\n    /*\n     * The unit name, e.g., meter\n     */\n    this.name_ = attrs['name_'] || '';\n\n    /*\n     * The unit's case-sensitive code, e.g., m\n     */\n    this.csCode_ = attrs['csCode_'] || '';\n\n    /*\n     * The unit's case-insensitive code, e.g., M\n     */\n    this.ciCode_ = attrs['ciCode_'] || '';\n\n    /*\n     * The unit's property, e.g., length\n     */\n    this.property_ = attrs['property_'] || '';\n\n    /*\n     * The magnitude of the unit, e.g., 3600/3937 for a yard,\n     * where a yard - 3600/3973 * m(eter).  The Dimension\n     * property specifies the meter - which is the unit on which\n     * a yard is based, and this magnitude specifies how to figure\n     * this unit based on the base unit.\n     */\n    this.magnitude_ = attrs['magnitude_'] || 1;\n\n    /*\n     * The Dimension object of the unit\n     */\n    if (attrs['dim_'] === undefined || attrs['dim_'] === null) {\n      this.dim_ = new Dimension();\n    }\n    // When the unit data stored in json format is reloaded, the dimension data\n    // is recognized as a a hash, not as a Dimension object.\n    else if (attrs['dim_']['dimVec_'] !== undefined) {\n      this.dim_ = new Dimension(attrs['dim_']['dimVec_']) ;\n    }\n    else if (attrs['dim_'] instanceof Dimension) {\n      this.dim_ = attrs['dim_'];\n    }\n    else if (attrs['dim_'] instanceof Array || isInteger(attrs['dim_'])) {\n      this.dim_ = new Dimension(attrs['dim_']) ;\n    }\n    else {\n      this.dim_ = new Dimension();\n    }\n    /*\n     * The print symbol of the unit, e.g., m\n     */\n    this.printSymbol_ = attrs['printSymbol_'] || null;\n\n    /*\n     * The class of the unit, where given, e.g., dimless\n     */\n    this.class_ = attrs['class_'] || null;\n\n    /*\n     * A flag indicating whether or not the unit is metric\n     */\n    this.isMetric_ = attrs['isMetric_'] || false;\n\n    /*\n     * The \"variable\" - which I think is used only for base units\n     * The symbol for the variable as used in equations, e.g., s for distance\n     */\n    this.variable_ = attrs['variable_'] || null ;  // comes from 'dim' in XML\n\n    /*\n     * The conversion function\n     */\n    this.cnv_ = attrs['cnv_'] || null;\n\n    /*\n     * The conversion prefix\n     */\n    this.cnvPfx_ = attrs['cnvPfx_'] || 1;\n\n    /*\n     * Flag indicating whether or not this is a \"special\" unit, i.e., is\n     * constructed using a function specific to the measurement, e.g.,\n     * fahrenheit and celsius\n     */\n    this.isSpecial_ = attrs['isSpecial_'] || false ;\n\n    /*\n     * Flag indicating whether or not this is an arbitrary unit\n     */\n    this.isArbitrary_ = attrs['isArbitrary_'] || false;\n\n    /*\n     * Integer indicating what level of exponent applies to a mole-based portion\n     * of the unit.  So, for the unit \"mol\", this will be 1.  For \"mol2\" this\n     * will be 2.  For \"1/mol\" this will be -1.  Any unit that does not include\n     * a mole will have a 0 in this field.  This is used to determine\n     * commensurability for mole<->mass conversions.\n     */\n    this.moleExp_ = attrs['moleExp_'] || 0;\n\n    /**\n     * Flag indicating whether or not this is a equivalent mole unit\n     */\n    this.equivalentExp_ = attrs['equivalentExp_'] || 0;\n\n    /*\n     * Added when added LOINC list of units\n     * synonyms are used by the autocompleter to enhance lookup capabilities\n     * while source says where the unit first shows up.  Current sources are\n     * UCUM - which are units from the unitsofmeasure.org list and LOINC -\n     * which are units from the LOINC data.\n     */\n    this.synonyms_ = attrs['synonyms_'] || null ;\n    this.source_ = attrs['source_'] || null ;\n    this.loincProperty_ = attrs['loincProperty_'] || null;\n    this.category_ = attrs['category_'] || null;\n    this.guidance_ = attrs['guidance_'] || null;\n\n    /*\n     * Used to compute dimension; storing for now until I complete\n     * unit definition parsing\n     */\n    /*\n     * Case sensitive (cs) and case insensitive (ci) base unit strings,\n     * includes exponent and prefix if applicable - specified in\n     * <value Unit=x UNIT=X value=\"nnn\">nnn</value> -- the unit part --\n     * in the ucum-essence.xml file, and may be specified by a user\n     * when requesting conversion or validation of a unit string.  The\n     * magnitude (base factor) is used with this to determine the new unit.\n     * For example, a Newton (unit code N) is created from the string\n     * kg.m/s2, and the value of 1 (base factor defined below). An hour\n     * (unit code h) is created from the unit min (minute) with a value\n     * of 60.\n     */\n    this.csUnitString_ = attrs['csUnitString_'] || null ;\n    this.ciUnitString_ = attrs['ciUnitString_'] || null ;\n\n    /*\n     * String and numeric versions of factor applied to unit specified in\n     * <value Unit=x UNIT=X value=\"nnn\">nnn</value> -- the value part\n     */\n    this.baseFactorStr_ = attrs['baseFactorStr_'] || null;\n    this.baseFactor_ = attrs['baseFactor_'] || null;\n\n    /*\n     * Flag used to indicate units where the definition process failed\n     * when parsing units from the official units definitions file\n     * (currently using the ucum-essence.xml file).  We keep these\n     * so that we can use them to at least validate them as valid\n     * units, but we don't try to convert them.   This is temporary\n     * and only to account for instances where the code does not\n     * take into account various special cases in the xml file.\n     *\n     * This is NOT used when trying to validate a unit string\n     * submitted during a conversion or validation attempt.\n     */\n    this.defError_ = attrs['defError_'] || false ;\n\n\n  } // end constructor\n\n\n  /**\n   * Assign the unity (= dimensionless unit 1) to this unit.\n   *\n   * @return this unit\n   */\n  assignUnity() {\n    this.name_  = \"\" ;\n    this.magnitude_ = 1 ;\n    if (!this.dim_)\n      this.dim_ = new Dimension();\n    this.dim_.assignZero() ;\n    this.cnv_ = null ;\n    this.cnvPfx_ = 1 ;\n    return this;\n\n  } // end assignUnity\n\n\n  /**\n   * This assigns one or more values, as provided in the hash passed in,\n   * to this unit.\n   *\n   * @param vals hash of values to be assigned to the attributes\n   *        specified by the key(s), which should be the attribute\n   *        name without the trailing underscore, e.g., name instead\n   *        of name_.\n   * @return nothing\n   */\n  assignVals(vals) {\n    for (let key in vals) {\n      let uKey = !(key.charAt(key.length - 1)) === '_' ? key + '_' : key ;\n      if (this.hasOwnProperty(uKey))\n        this[uKey] = vals[key];\n      else\n        throw(new Error(`Parameter error; ${key} is not a property of a Unit`));\n    }\n  } // end assignVals\n\n\n  /**\n   * This creates a clone of this unit.\n   *\n   * @return the clone\n   */\n  clone() {\n    let retUnit = new Unit() ;\n    Object.getOwnPropertyNames(this).forEach(val => {\n      if (val === 'dim_') {\n        if (this['dim_'])\n          retUnit['dim_'] = this['dim_'].clone();\n        else\n          retUnit['dim_'] = null;\n      }\n      else\n        retUnit[val] = this[val];\n    });\n    return retUnit ;\n\n  } // end clone\n\n\n  /**\n   * This assigns all properties of a unit passed to it to this unit.\n   *\n   * @param unit2 the unit whose properties are to be assigned to this one.\n   * @return nothing; this unit is updated\n   */\n  assign(unit2) {\n    Object.getOwnPropertyNames(unit2).forEach(val => {\n      if (val === 'dim_') {\n        if (unit2['dim_'])\n          this['dim_'] = unit2['dim_'].clone();\n        else\n          this['dim_'] = null;\n      }\n      else {\n        this[val] = unit2[val];\n      }\n    });\n  } // end assign\n\n\n  /**\n   * This determines whether or not object properties of the unit\n   * passed in are equal to the corresponding properties in this unit.\n   * The following properties are the only ones checked:\n   *   magnitude_, dim_, cnv_ and cnvPfx_\n   *\n   * @param unit2 the unit whose properties are to be checked.\n   * @return boolean indicating whether or not they match\n   */\n  equals(unit2) {\n\n    return (this.magnitude_ === unit2.magnitude_ &&\n            this.cnv_ === unit2.cnv_ &&\n            this.cnvPfx_ === unit2.cnvPfx_ &&\n            ((this.dim_ === null && unit2.dim_ === null) ||\n             this.dim_.equals(unit2.dim_)));\n\n  } // end equals\n\n\n  /**\n   * This method compares every attribute of two objects to determine\n   * if they all match.\n   *\n   * @param unit2 the unit that is to be compared to this unit\n   * @return boolean indicating whether or not every attribute matches\n   */\n  fullEquals(unit2) {\n\n    let thisAttr = Object.keys(this).sort();\n    let u2Attr = Object.keys(unit2).sort();\n\n    let keyLen = thisAttr.length ;\n    let match = (keyLen === u2Attr.length);\n\n    // check each attribute.   Dimension objects have to checked using\n    // the equals function of the Dimension class.\n    for (let k = 0; k < keyLen && match; k++) {\n      if (thisAttr[k] === u2Attr[k]) {\n        if (thisAttr[k] === 'dim_')\n          match = this.dim_.equals(unit2.dim_);\n        else\n          match = this[thisAttr[k]] === unit2[thisAttr[k]];\n      }\n      else\n        match = false ;\n    } // end do for each key and attribute\n    return match ;\n  }// end of fullEquals\n\n\n  /**\n   * This returns the value of the property named by the parameter\n   * passed in.\n   *\n   * @param propertyName name of the property to be returned, with\n   *        or without the trailing underscore.\n   * @return the requested property, if found for this unit\n   * @throws an error if the property is not found for this unit\n   */\n  getProperty(propertyName) {\n    let uProp = propertyName.charAt(propertyName.length - 1) === '_' ? propertyName :\n                                             propertyName + '_' ;\n    return this[uProp] ;\n\n  } // end getProperty\n\n\n  /**\n   * Takes a measurement consisting of a number of units and a unit and returns\n   * the equivalent number of this unit.  So, 15 mL would translate\n   * to 1 tablespoon if this object is a tablespoon.\n   *\n   * Note that the number returned may not be what is normally expected.\n   * For example, converting 10 Celsius units to Fahrenheit would \"normally\"\n   * return a value of 50.   But in this case you'll get back something like\n   * 49.99999999999994.\n   *\n   * If either unit is an arbitrary unit an exception is raised.\n   *\n   * @param num the magnitude for the unit to be translated (e.g. 15 for 15 mL)\n   * @param fromUnit the unit to be translated to one of this type (e.g. a mL unit)\n   *\n   * @return the number of converted units (e.g. 1 for 1 tablespoon)\n   * @throws an error if the dimension of the fromUnit differs from this unit's\n   * dimension\n   */\n  convertFrom(num, fromUnit) {\n    let newNum = 0.0 ;\n\n    if (this.isArbitrary_)\n      throw (new Error(`Attempt to convert to arbitrary unit \"${this.csCode_}\"`));\n    if (fromUnit.isArbitrary_)\n      throw (new Error(`Attempt to convert arbitrary unit \"${fromUnit.csCode_}\"`));\n\n    // reject request if both units have dimensions that are not equal\n    if (fromUnit.dim_ && this.dim_ && !(fromUnit.dim_.equals(this.dim_))) {\n      // check first to see if a mole<->mass conversion is appropriate\n      if (this.isMolMassCommensurable(fromUnit)) {\n        throw(new Error(Ucum.needMoleWeightMsg_));\n      }\n      else {\n        throw(new Error(`Sorry.  ${fromUnit.csCode_} cannot be converted ` +\n          `to ${this.csCode_}.`));\n      }\n    }\n    // reject request if there is a \"from\" dimension but no \"to\" dimension\n    if (fromUnit.dim_ && (!this.dim_ || this.dim_.isNull())) {\n      throw(new Error(`Sorry.  ${fromUnit.csCode_} cannot be converted ` +\n        `to ${this.csCode_}.`));\n    }\n\n    // reject request if there is a \"to\" dimension but no \"from\" dimension\n    if (this.dim_ && (!fromUnit.dim_ || fromUnit.dim_.isNull())) {\n      throw(new Error(`Sorry.  ${fromUnit.csCode_} cannot be converted ` +\n        `to ${this.csCode_}.`));\n    }\n\n    let fromCnv = fromUnit.cnv_ ;\n    let fromMag = fromUnit.magnitude_ ;\n\n    let x;\n    if (fromCnv != null) {\n      // turn num * fromUnit.magnitude into its ratio scale equivalent,\n      // e.g., convert Celsius to Kelvin\n      let fromFunc = funcs.forName(fromCnv);\n      x = fromFunc.cnvFrom(num * fromUnit.cnvPfx_) * fromMag;\n      //x = fromFunc.cnvFrom(num * fromMag) * fromUnit.cnvPfx_;\n    }\n    else {\n      x = num * fromMag;\n    }\n\n    if (this.cnv_ != null) {\n      // turn mag * origUnit on ratio scale into a non-ratio unit,\n      // e.g. convert Kelvin to Fahrenheit\n      let toFunc = funcs.forName(this.cnv_);\n      newNum = toFunc.cnvTo(x / this.magnitude_) / this.cnvPfx_;\n    }\n    else {\n      newNum = x / this.magnitude_;\n    }\n\n    return newNum;\n\n  } // end convertFrom\n\n\n  /**\n   * Takes a number and a target unit and returns the number for a measurement\n   * of this unit that corresponds to the number of the target unit passed in.\n   * So, 1 tablespoon (where this unit represents a tablespoon) would translate\n   * to 15 mL.\n   *\n   * See the note on convertFrom about return values.\n   *\n   * @param mag the magnitude for this unit (e.g. 1 for 1 tablespoon)\n   * @param toUnit the unit to which this unit is to be translated\n   *  (e.g. an mL unit)\n   *\n   * @return the converted number value (e.g. 15 mL)\n   * @throws an error if the dimension of the toUnit differs from this unit's\n   *   dimension\n   */\n  convertTo(num, toUnit) {\n\n    return toUnit.convertFrom(num, this) ;\n\n  } // end convertTo\n\n\n  /**\n   * Takes a given number of this unit returns the number of this unit\n   * if it is converted into a coherent unit.  Does not change this unit.\n   *\n   * If this is a coherent unit already, just gives back the number\n   * passed in.\n   *\n   * @param num the number for the coherent version of this unit\n   * @return the number for the coherent version of this unit\n   */\n  convertCoherent(num) {\n\n    // convert mag' * u' into canonical number * u on ratio scale\n    if(this.cnv_ !== null)\n      num = this.cnv_.f_from(num / this.cnvPfx_) * this.magnitude_;\n\n    return num;\n\n  } // end convertCoherent\n\n\n  /**\n   * Mutates this unit into a coherent unit and converts a given number of\n   * units to the appropriate value for this unit as a coherent unit\n   *\n   * @param num the number for this unit before conversion\n   * @return the number of this unit after conversion\n   * @throws an error if the dimensions differ\n   */\n  mutateCoherent(num) {\n\n    // convert mu' * u' into canonical mu * u on ratio scale\n    num = this.convertCoherent(num) ;\n\n    // mutate to coherent unit\n    this.magnitude_ = 1;\n    this.cnv_ = null;\n    this.cnvPfx_ = 1;\n    this.name_ = \"\";\n\n    // build a name as a term of coherent base units\n    // This is probably ALL WRONG and a HORRIBLE MISTAKE\n    // but until we figure out what the heck the name being\n    // built here really is, it will have to stay.\n    for (let i = 0, max = Dimension.getMax(); i < max; i++) {\n      let elem = this.dim_.getElementAt(i);\n      let tabs = this._getUnitTables();\n      let uA = tabs.getUnitsByDimension(new Dimension(i));\n      if(uA == null)\n        throw(new Error(`Can't find base unit for dimension ${i}`));\n      this.name_ = uA.name + elem;\n    }\n    return num;\n\n  } // end mutateCoherent\n\n\n  /**\n   * This function converts between mol and mass (in either direction)\n   * using the molecular weight of the substance.  It assumes that the\n   * isMolMassCommensurable\" function has been called to check that the units are\n   * commensurable.\n  *\n   * @param amt the quantity of this unit to be converted\n   * @param toUnit the target/to unit for which the converted # is wanted\n   * @param molecularWeight the molecular weight of the substance for which the\n   * conversion is being made\n   * @return the equivalent amount in toUnit\n   */\n  convertMolMass(amt, toUnit, molecularWeight) {\n    // In the calculations below we are treating \"molecularWeight\" (measured in\n    // a.m.u) as the molar weight (measured in g/mol).  The values are the same,\n    // though the units differ.\n\n    // Determine the number of powers of mol we have to convert to mass.\n    // Typically this will be just 1, or -1, but not necessarily.  If it is a\n    // negative number, then we are really converting mass to moles.\n    const molPowersToConvert  = this.moleExp_ - toUnit.moleExp_;\n    // A simple mole unit has a magnitude of avogadro's number.  Get that\n    // number now (since not everyone agrees on what it is, and what is\n    // being used in this system might change).\n    let tabs = this._getUnitTables();\n    let avoNum = tabs.getUnitByCode('mol').magnitude_ ;\n    // For each molPowersToConvert, we need to multiply the mol unit by the\n    // molar weight (g/mol) and divide by avoNum (1/mol) to get a weight per\n    // molecule.  (Note that the magnitude_ of each unit will contain factors of\n    // avoNum, of which we are thus getting rid of some).\n    let moleUnitFactor = Math.pow(molecularWeight/avoNum, molPowersToConvert);\n    // The new value is proportional to this.magnitude_, amt, and\n    // moleUnitFactor, and inversely proportional to toUnit_.magnitude.\n    return this.magnitude_/toUnit.magnitude_ * moleUnitFactor * amt;\n  } // end convertMolMass\n\n\n  /**\n   * This function converts between equivalants and mass (in either direction)\n   * using the charge of the substance.  It assumes that the\n   * isEqMassCommensurable\" function has been called to check that the units are\n   * commensurable.\n   *\n   * @param {number} amt - The amount of this unit to be converted.\n   * @param {object} toUnit - The target/to unit for which the converted number is wanted.\n   * @param {number} molecularWeight - The molecular weight of the substance for which the conversion is being made.\n   * @param {number} charge - The absolute value of the charge of the substance for which the conversion is being made.\n   * @returns {number} - The amount in the specified toUnit.\n   */\n  convertEqMass(amt, toUnit, molecularWeight, charge) {\n    // Determine the number of powers of mass we have to convert to equivalents.\n    // Typically this will be just 1, or -1, but not necessarily.  If it is a\n    // negative number, then we are converting in the opposite direciton.\n    // Because the units are presumed commensurable, we can use the\n    // equivalentExp_ instead of the mass dimension.\n    const massPowersToConvert  = toUnit.equivalentExp_ - this.equivalentExp_ ;\n    // Calculate equivalent mass by dividing molecular weight by charge\n    let equivalentMass = molecularWeight / charge;\n    // Get Avogadro's number from the unit tables\n    let avogadroNumber =  this._getUnitTables().getUnitByCode('mol').magnitude_ ;\n    // Calculate equivalents by dividing mass by equivalent mass, for each\n    // power to be converted.\n    let equivalents = this.magnitude_ * amt / Math.pow(equivalentMass, massPowersToConvert);\n    // Calculate mole factor by dividing the magnitude of the equivalent unit by\n    // Avogadro's number.  toUnit may have a prefix (e.g. meq) and we need to adjust for that, for\n    // each massPowersToConvert.\n    let moleFactor = toUnit.magnitude_ / Math.pow(avogadroNumber, massPowersToConvert);\n    // Adjust equivalents by dividing by the mole factor\n    let adjustedEquivalents = equivalents / moleFactor;\n    // Return the adjusted equivalents\n    return adjustedEquivalents;\n  } // end convertMassToEq\n\n\n  /**\n   *  Converts a unit with eq/mol/mass to another unit with eq/mol/mass.  It\n   *  assumes the units an commensurable, which can be checked via\n   *  isEqMolMassCommensurable.  It also assumes that the powers of eq/mol/mass\n   *  are different between the two units; otherwise it would be more efficient\n   *  to call one of the other convert... functions.\n   *\n   * @param {number} amt - The amount of this unit to be converted.\n   * @param {object} toUnit - The target/to unit for which the converted number is wanted.\n   * @param {number} molecularWeight - The molecular weight of the substance for which the conversion is being made.\n   * @param {number} charge - The absolute value of the charge of the substance for which the conversion is being made.\n   * @returns {number} - The equivalent amount in the specified equivalent unit.\n   */\n  convertEqMolMass(amt, toUnit, molecularWeight, charge) {\n    // Handle the equivalent differences.  It important for the following\n    // calculations (for consistency) that we consider the difference in\n    // equivalent powers and not mol powers, so we are not calling\n    // convertEqToMol, in case its implementation changes.\n    // See convertEqToMol for details.  One difference is that we do not scale\n    // by magnitude_ until the end.\n    const eqPowersToConvert  = this.equivalentExp_ - toUnit.equivalentExp_;\n    const molAmt = amt / Math.pow(charge, eqPowersToConvert);\n    // Now for the mol/mass converstion part, we consider only the mass power\n    // differences, and not the mol power differences (which were partially\n    // handled in the eq/mol step above).\n    // Again, see convertMolToMass for details on the calculations.\n    const tabs = this._getUnitTables();\n    const d = tabs.getMassDimensionIndex();\n    const massPowersToConvert = this.dim_.getElementAt(d) - toUnit.dim_.getElementAt(d);\n    const molPowersToConvert = -massPowersToConvert; // so the formulas follow convertMolToMass\n    const avoNum = tabs.getUnitByCode('mol').magnitude_ ;\n    let moleUnitFactor = Math.pow(molecularWeight/avoNum, molPowersToConvert);\n    return this.magnitude_/toUnit.magnitude_ * moleUnitFactor * molAmt;\n  }\n\n\n  /**\n   * Checks if the given unit is an equivalent unit.\n   *\n   * Note: equivalent units are also be molar units, so a unit can return true for\n   * both isEquivalentUnit and isMolarUnit.\n   *\n   * @returns {boolean} - Returns true if the unit is an equivalent unit, false otherwise.\n   */\n  isEquivalentUnit() {\n    return this.equivalentExp_ !== 0;\n  } // end isEquivalentUnit\n\n  /**\n   * Checks if the given unit is a molar unit.\n   *\n   * @returns {boolean} - Returns true if the unit is a molar unit, false otherwise.\n   */\n  isMolarUnit() {\n    return this.moleExp_ !== 0;\n  } // end isMolarUnit\n\n\n  /**\n   * This function converts between equivalants and moles (in either direction)\n   * using the charge of the substance.  It assumes that the\n   * isEqMolCommensurable\" function has been called to check that the units are\n   * commensurable.\n\n   * As with the other \"convert\" functions, it assumes the appropriate\n   * \"is...Commensurable\" function has been called.\n   *\n   * @param {number} amt - The amount of this unit for which the conversion is being made.\n   * @param {object} toUnit - The target unit for which the converted number is wanted.\n   * @param {number} charge - The absolute value of the charge of the substance for which the conversion is being made.\n   * @return {number} - The amount in molToUnit.\n   */\n  convertEqMol(amt, toUnit, charge) {\n    // Determine the number of powers of eq we have to convert to mol.\n    // Typically this will be just 1, or -1, but not necessarily.  If it is a\n    // negative number, then we are really converting mol to eq.\n    const eqPowersToConvert  = this.equivalentExp_ - toUnit.equivalentExp_;\n\n    // A simple mole unit has a magnitude of avogadro's number.\n    // So does 'eq' (equivalent) because in ucum it is defined as 1 mol, though\n    // that does not account for the charge.  Therefore, we don't need to\n    // account for that factor in this conversion.\n\n    // The conversion from equivalents to moles is based on the principle that\n    // one equivalent is equal to 1/charge moles (per eqPowersToConvert).\n    // The relative magnitude is accounted for via the current unit's magnitude\n    // (this.magnitude_) and the target unit's magnitude (molToUnit.magnitude_)\n    // For each eqPowersToConvert, we need to divide by the charge.\n    return amt * (this.magnitude_ / toUnit.magnitude_) / Math.pow(charge, eqPowersToConvert);\n  } // end convertEqMol\n\n\n  /**\n   * Mutates this unit into a unit on a ratio scale and converts a specified\n   * number of units to an appropriate value for this converted unit\n   *\n   * @param num the number of this unit before it's converted\n   * @return the magnitude of this unit after it's converted\n   * @throw an error if the dimensions differ\n   */\n  mutateRatio(num) {\n    if (this.cnv_ == null)\n      return this.mutateCoherent(num);\n    else\n      return num;\n\n  } // end mutateRatio\n\n\n  /**\n   * Multiplies this unit with a scalar. Special meaning for\n   * special units so that (0.1*B) is 1 dB.\n   *\n   * This function DOES NOT modify this unit.\n   *\n   * @param s the value by which this unit is to be multiplied\n   * @return a copy this unit multiplied by s\n   * */\n  multiplyThis(s) {\n\n    let retUnit = this.clone() ;\n    if (retUnit.cnv_ != null)\n      retUnit.cnvPfx_ *= s;\n    else\n      retUnit.magnitude_ *= s;\n    let mulVal = s.toString();\n    retUnit.name_ = this._concatStrs(mulVal, '*', this.name_, '[', ']');\n    retUnit.csCode_ = this._concatStrs(mulVal, '.', this.csCode_, '(', ')');\n    retUnit.ciCode_ = this._concatStrs(mulVal, '.', this.ciCode_, '(', ')');\n    retUnit.printSymbol_ = this._concatStrs(mulVal, '.', this.printSymbol_,\n        '(', ')');\n\n    return retUnit;\n\n  } // end multiplyThis\n\n\n  /**\n   * Multiplies this unit with another unit. If one of the\n   * units is a non-ratio unit the other must be dimensionless or\n   * else an exception is thrown.\n   *\n   * This function does NOT modify this unit\n   * @param unit2 the unit to be multiplied with this one\n   * @return this unit after it is multiplied\n   * @throws an error if one of the units is not on a ratio-scale\n   *         and the other is not dimensionless.\n   */\n  multiplyThese(unit2) {\n\n    var retUnit = this.clone() ;\n\n    if (retUnit.cnv_ != null) {\n      if (unit2.cnv_ == null && (!unit2.dim_ || unit2.dim_.isZero()))\n        retUnit.cnvPfx_ *= unit2.magnitude_;\n      else\n        throw (new Error(`Attempt to multiply non-ratio unit ${retUnit.name_} ` +\n          'failed.'));\n    } // end if this unit has a conversion function\n\n    else if (unit2.cnv_ != null) {\n      if (!retUnit.dim_ || retUnit.dim_.isZero()) {\n        retUnit.cnvPfx_ = unit2.cnvPfx_ * retUnit.magnitude_;\n        retUnit.magnitude_ = unit2.magnitude_;\n        retUnit.cnv_ = unit2.cnv_ ;\n      }\n      else\n        throw (new Error(`Attempt to multiply non-ratio unit ${unit2.name_}`));\n    } // end if unit2 has a conversion function\n\n    // else neither unit has a conversion function\n    else {\n      retUnit.magnitude_ *= unit2.magnitude_;\n    } // end if unit2 does not have a conversion function\n\n    // If this.dim_ isn't there, clone the dimension in unit2 - if dimVec_\n    // is a dimension in unit2.dim_; else just transfer it to this dimension\n    if (!retUnit.dim_ || (retUnit.dim_ && !retUnit.dim_.dimVec_)) {\n      if (unit2.dim_)\n        retUnit.dim_ = unit2.dim_.clone();\n      else\n        retUnit.dim_ = unit2.dim_;\n    }\n    // Else this.dim_ is there.  If there is a dimension for unit2,\n    // add it to this one.\n    else if (unit2.dim_ && unit2.dim_ instanceof Dimension) {\n      retUnit.dim_.add(unit2.dim_);\n    }\n\n    // Add the values of equivalentExp_ and moleExp for the two units\n    retUnit.equivalentExp_ += unit2.equivalentExp_;\n    retUnit.moleExp_ += unit2.moleExp_;\n\n    // Concatenate the unit info (name, code, etc) for all cases\n    // where the multiplication was performed (an error wasn't thrown)\n    retUnit.name_ = this._concatStrs(retUnit.name_, '*', unit2.name_, '[', ']');\n    retUnit.csCode_ = this._concatStrs(retUnit.csCode_, '.', unit2.csCode_,\n      '(', ')');\n    if (retUnit.ciCode_ && unit2.ciCode_)\n      retUnit.ciCode_ = this._concatStrs(retUnit.ciCode_, '.', unit2.ciCode_,\n        '(', ')');\n    else if (unit2.ciCode_)\n      retUnit.ciCode_ = unit2.ciCode_;\n    retUnit.resetFieldsForDerivedUnit();\n    if (retUnit.printSymbol_ && unit2.printSymbol_)\n      retUnit.printSymbol_ = this._concatStrs(retUnit.printSymbol_, '.',\n        unit2.printSymbol_, '(', ')');\n    else if (unit2.printSymbol_)\n      retUnit.printSymbol_ = unit2.printSymbol_;\n\n    // A unit that has the arbitrary attribute taints any unit created from it\n    // via an arithmetic operation.  Taint accordingly\n    // if (!retUnit.isMole_)\n    //   retUnit.isMole_ = unit2.isMole_ ;\n    if (!retUnit.isArbitrary_)\n      retUnit.isArbitrary_ = unit2.isArbitrary_;\n\n    // Likewise for special units\n    if (!retUnit.isSpecial_)\n      retUnit.isSpecial_ = unit2.isSpecial_;\n\n    return retUnit ;\n\n  } // end multiplyThese\n\n\n  /**\n   *  Clears fields like isBase_, synonyms_, etc. when a unit has been cloned\n   *  from a known unit but it being used to construct a derived unit.\n   */\n  resetFieldsForDerivedUnit() {\n    this.guidance_ = '';\n    this.synonyms_ = null;\n    this.isBase_ = false;\n  }\n\n\n  /**\n   * Divides this unit by another unit. If this unit is not on a ratio\n   * scale an exception is raised. Mutating to a ratio scale unit\n   * is not possible for a unit, only for a measurement.\n   *\n   * This unit is NOT modified by this function.\n   * @param unit2 the unit by which to divide this one\n   * @return this unit after it is divided by unit2\n   * @throws an error if either of the units is not on a ratio scale.\n   * */\n  divide(unit2) {\n\n    var retUnit = this.clone();\n\n    if (retUnit.cnv_ != null)\n      throw (new Error(`Attempt to divide non-ratio unit ${retUnit.name_}`));\n    if (unit2.cnv_ != null)\n      throw (new Error(`Attempt to divide by non-ratio unit ${unit2.name_}`));\n\n    if (retUnit.name_ && unit2.name_)\n      retUnit.name_ = this._concatStrs(retUnit.name_, '/', unit2.name_, '[', ']');\n    else if (unit2.name_)\n      retUnit.name_ = unit2.invertString(unit2.name_);\n\n    retUnit.csCode_ = this._concatStrs(retUnit.csCode_, '/', unit2.csCode_,\n      '(', ')');\n\n    if (retUnit.ciCode_ && unit2.ciCode_)\n      retUnit.ciCode_ = this._concatStrs(retUnit.ciCode_, '/', unit2.ciCode_,\n      '(', ')');\n    else if (unit2.ciCode_)\n      retUnit.ciCode_ = unit2.invertString(unit2.ciCode_) ;\n\n    retUnit.resetFieldsForDerivedUnit();\n\n    retUnit.magnitude_ /= unit2.magnitude_;\n\n    if (retUnit.printSymbol_ && unit2.printSymbol_)\n      retUnit.printSymbol_ = this._concatStrs(retUnit.printSymbol_, '/',\n        unit2.printSymbol_, '(', ')');\n    else if (unit2.printSymbol_)\n      retUnit.printSymbol_ = unit2.invertString(unit2.printSymbol_);\n\n    // Continue if unit2 has a dimension object.\n    // If this object has a dimension object, subtract unit2's dim_ object from\n    // this one. The sub method will take care of cases where the dimVec_ arrays\n    // are missing on one or both dim_ objects.\n    if (unit2.dim_) {\n      if (retUnit.dim_) {\n        if (retUnit.dim_.isNull())\n          retUnit.dim_.assignZero();\n        retUnit.dim_ = retUnit.dim_.sub(unit2.dim_);\n      } // end if this.dim_ exists\n\n      // Else if this dim_ object is missing, clone unit2's dim_ object\n      // and give the inverted clone to this unit.\n      else\n        retUnit.dim_ = unit2.dim_.clone().minus();\n    } // end if unit2 has a dimension object\n\n    // Update the mole exponent count by subtracting the count for unit2 from\n    // the count for this unit.\n    retUnit.moleExp_ -= unit2.moleExp_ ;\n    // Also update the equivalent exponent.\n    retUnit.equivalentExp_ -= unit2.equivalentExp_;\n\n    // A unit that has the arbitrary attribute taints any unit created from\n    // it via an arithmetic operation.  Taint accordingly\n    // if (!retUnit.isMole_)\n    //   retUnit.isMole_ = unit2.isMole_ ;\n    if (!retUnit.isArbitrary_)\n      retUnit.isArbitrary_ = unit2.isArbitrary_;\n\n    return retUnit;\n\n  } // end divide\n\n\n  /**\n   * This function is not actually used by the other code, except for some test\n   * code, and might not be adequately tested.\n   *\n   * Invert this unit with respect to multiplication. If this unit is not\n   * on a ratio scale an exception is thrown. Mutating to a ratio scale unit\n   * is not possible for a unit, only for a measurement (the magnitude and\n   * dimension).\n   *\n   *  This unit is modified by this function.\n   * @return this unit after being inverted\n   * @throws and error if this unit is not on a ratio scale\n   */\n  invert() {\n    var retUnit = this.clone() ;\n    if (this.cnv_ != null)\n      throw (new Error(`Attempt to invert a non-ratio unit - ${this.name_}`));\n\n    retUnit.name_ = this.invertString(this.name_);\n    retUnit.magnitude_ = 1/this.magnitude_ ;\n    retUnit.dim_.minus();\n\n    // Also update  equivalentExp_ and moleExp\n    retUnit.equivalentExp_ = -this.equivalentExp_;\n    retUnit.moleExp_ = -this.moleExp_;\n\n    return retUnit;\n\n  } // end invert\n\n\n  /**\n   * Inverts a string, where the string is assumed to be a code or a name\n   * of a division operation where the string is the divisor and the dividend\n   * is blank.\n   *\n   * @param the string to be inverted\n   * @return the inverted string\n   */\n  invertString(theString) {\n\n    if (theString.length > 0) {\n      // replace('<!', '</') is here to make sure closing html tags like </sup> are intact. See LF-2830.\n      let stringRep = theString.replace('/', \"!\").replace('.', '/').replace('<!', '</').replace(\"!\", '.');\n      switch(stringRep.charAt(0)) {\n        case '.' : theString = stringRep.substr(1); break;\n        case '/' : theString = stringRep; break;\n        default  : theString = \"/\" + stringRep;\n      }\n    }\n    return theString;\n\n  } // end invertString\n\n\n  /**\n   * This function handles concatenation of two strings and an operator.\n   * It's called to build unit data, e.g., unit name, unit code, etc., from\n   * two different units, joined by the specified operator.\n   *\n   * @param str1 the first string to appear in the result\n   * @param operator the operator ('*', '.' or '/') to appear between the strings\n   * @param str2 the second string to appear in the result\n   * @param startChar the starting character to be used, when needed, to\n   *  enclose a string\n   * @param endChar the ending character to be used, when needed, to enclose\n   *  a string\n   * @returns the built string\n   */\n  _concatStrs(str1, operator, str2, startChar, endChar) {\n\n    return this._buildOneString(str1, startChar, endChar) +\n      operator + this._buildOneString(str2, startChar, endChar) ;\n  }\n\n\n  /**\n   * This function handles creation of one string to be included in a\n   * concatenated string.   Basically it checks to see if the string\n   * needs to be enclosed either in parentheses or square brackets.\n   *\n   * The string is enclosed if it is not a number, is not already enclosed in a pair of\n   * parentheses or square brackets, and includes a period, and asterisk,\n   * a slash or a blank space.\n   *\n   * @param str the string\n   * @param startChar starting enclosing character\n   * @param endChar ending enclosing character\n   * @returns the string\n   */\n  _buildOneString(str, startChar, endChar) {\n    let ret = '' ;\n    if (intUtils_.isNumericString(str)) {\n      ret = str;\n    }\n    else {\n      if (str.charAt(0) === '(' && str.endsWith(')') || str.charAt(0) === '['  && str.endsWith(']')) {\n        ret = str;\n      }\n      else if (/[./* ]/.test(str)) {\n        ret = startChar + str + endChar ;\n      }\n      else {\n        ret = str ;\n      }\n    }\n    return ret ;\n  }\n\n\n  /**\n   * This function is not actually used by the other code, except for some test\n   * code, and might not be adequately tested.\n   *\n   * Raises the unit to a power.  For example\n   *  kg.m/s2 raised to the -2 power would be kg-2.m-2/s-4\n   *\n   * If this unit is not on a ratio scale an error is thrown. Mutating\n   * to a ratio scale unit is not possible for a unit, only for a\n   * measurement (magnitude and dimension).\n   *\n   * This is based on the pow method in Gunter Schadow's java version,\n   * although it uses javascript capabilities to simplify the processing.\n   *\n   * This unit is modified by this function\n   *\n   * @param p the power to with this unit is to be raise\n   * @return this unit after it is raised\n   * @throws an error if this unit is not on a ratio scale.\n   */\n  power(p) {\n\n    if (this.cnv_ != null)\n      throw (new Error(`Attempt to raise a non-ratio unit, ${this.name_}, ` +\n                       'to a power.'));\n\n    var retUnit = this.clone() ;\n    //this.name_ = UnitString.pow(this.name_, p);\n    // the above line is replaced with the code below, as the pow method\n    // never actually existing in the UnitString class.  (Tried to use\n    // Schadow java code but this way ended up being a lot easier).\n    let uStr = this.csCode_ ;\n    let uArray = uStr.match(/([./]|[^./]+)/g) ;\n    let arLen = uArray.length;\n\n    for (let i = 0; i < arLen; i++) {\n      let un = uArray[i] ;\n      if (un !== '/' && un !== '.') {\n        let nun = parseInt(un);\n        if (isInteger(nun))\n          uArray[i] = (Math.pow(nun, p).toString());\n        else {\n          let uLen = un.length ;\n          for (let u = uLen - 1; u >= 0; u--) {\n            let uChar = parseInt(un[u]);\n            if (!isInteger(uChar)) {\n              if (un[u] === '-' || un[u] === '+') {\n                u--;\n              }\n              if (u < uLen - 1) {\n                let exp = parseInt(un.substr(u));\n                exp = Math.pow(exp, p);\n                uArray[i] = un.substr(0, u) + exp.toString();\n                u = -1;\n              }\n              else {\n                uArray[i] += p.toString();\n                u = -1;\n              } // end if there are/aren't some numbers at the end\n              u = -1;\n            } // end if this character is not a number\n          } // end searching backwards for start of exponent\n        } // end if this element is not a number\n      } // end if the current element is not an operator\n    } // end do for each element of the units array\n\n    // reassemble the updated units array to a string\n    retUnit.csCode_ = uArray.join('');\n\n    retUnit.magnitude_ = Math.pow(this.magnitude_, p);\n    if (retUnit.dim_) {\n      retUnit.dim_.mul(p);\n    }\n\n    // Also update  equivalentExp_ and moleExp\n    retUnit.equivalentExp_ *= p;\n    retUnit.moleExp_ *= p;\n\n    return retUnit;\n\n  } // end power\n\n\n  /*\n   * This function tests this unit against the unit passed in to see if the\n   * two are mole to mass commensurable.  It assumes that one of the units\n   * is a mole-based unit and the other is a mass-based unit.  It also assumes\n   * that the mole-based unit has a single mole unit in the numerator and that\n   * the mass-based unit has a single mass unit in the numerator.  It does NOT\n   * check to validate those assumptions.\n   *\n   * The check is made by setting the dimension vector element corresponding\n   * to the base mass unit (gram) in the mole unit, and then comparing the\n   * two dimension vectors.  If they match, the units are commensurable.\n   * Otherwise they are not.\n   *\n   * @param unit2 the unit to be compared to this one\n   * @returns boolean indicating commensurability\n   */\n  isMolMassCommensurable(unit2) {\n    let tabs = this._getUnitTables();\n    let d = tabs.getMassDimensionIndex();\n    // Add the moleExp_ values to the mass values in the dimension vectors\n    // of each unit, and then compare them.\n    const unit1Dim = this.dim_.clone();\n    unit1Dim.setElementAt(d, (unit1Dim.getElementAt(d) + this.moleExp_));\n    const unit2Dim = unit2.dim_.clone();\n    unit2Dim.setElementAt(d, (unit2Dim.getElementAt(d) + unit2.moleExp_));\n    return (unit1Dim.equals(unit2Dim));\n  }\n\n\n  /**\n   * This function tests this unit against the unit passed in to see if the\n   * two are eq to mass commensurable.  It assumes that one of the units\n   * is a eq-based unit and the other is a mass-based unit.  It also assumes\n   * that the eq-based unit has a single eq unit in the numerator and that\n   * the mass-based unit has a single mass unit in the numerator.  It does NOT\n   * check to validate those assumptions.\n   *\n   * The check is made by setting the dimension vector element corresponding\n   * to the base mass unit (gram) in the eq unit, and then comparing the\n   * two dimension vectors.  If they match, the units are commensurable.\n   * Otherwise they are not.\n   *\n   * @param {Unit} unit2 the unit to be compared to this one\n   * @returns {boolean} boolean indicating commensurability\n   */\n  isEqMassCommensurable(unit2) {\n    let tabs = this._getUnitTables();\n    let d = tabs.getMassDimensionIndex();\n    // Add the equivalentExp_ values to the mass values in the dimension vectors\n    // of each unit, and then compare them.\n    const unit1Dim = this.dim_.clone();\n    unit1Dim.setElementAt(d, (unit1Dim.getElementAt(d) + this.equivalentExp_));\n    const unit2Dim = unit2.dim_.clone();\n    unit2Dim.setElementAt(d, (unit2Dim.getElementAt(d) + unit2.equivalentExp_));\n    return (unit1Dim.equals(unit2Dim));\n  }\n\n  /**\n   * This function tests this unit against the unit passed in to see if the\n   * two are eq to mass commensurable-- that the equivalents could be converted\n   * to the mass or vice-versa, in a way that makes the units commensurable.\n   *\n   * The check is made by adding the mole dimension to the equivalent dimension\n   * and comparing that result for the two units, along with the units'\n   * dimension vectors.  If they match, the units are\n   * commensurable.  Otherwise they are not.\n   *\n   * @param {Unit} unit2 the unit to be compared to this one\n   * @returns {boolean} boolean indicating commensurability\n   */\n  isEqMolCommensurable(unit2) {\n    const unit1Sum = this.equivalentExp_ + this.moleExp_;\n    const unit2Sum = unit2.equivalentExp_ + unit2.moleExp_;\n    return unit1Sum == unit2Sum && this.dim_.equals(unit2.dim_);\n  }\n\n\n  /**\n   * This function tests this unit against the unit passed in to see if the\n   * two are commensurable if eq, mol, and mass units are converted in some\n   * direction.\n   *\n   * The check is made by adding the eq,  mol, and mass  dimensions\n   * and comparing that result for the two units, along with the units'\n   * dimension vectors.  If they match, the units are\n   * commensurable.  Otherwise they are not.\n   *\n   * @param {Unit} unit2 the unit to be compared to this one\n   * @returns {boolean} boolean indicating commensurability\n   */\n  isEqMolMassCommensurable(unit2) {\n    const d = this._getUnitTables().getMassDimensionIndex();\n    const unit1Dim = this.dim_.clone();\n    unit1Dim.setElementAt(d, unit1Dim.getElementAt(d) + this.equivalentExp_ +\n      this.moleExp_);\n    const unit2Dim = unit2.dim_.clone();\n    unit2Dim.setElementAt(d, unit2Dim.getElementAt(d) + unit2.equivalentExp_ +\n      unit2.moleExp_);\n    return unit1Dim.equals(unit2Dim);\n  }\n\n\n  /**\n   * This returns the UnitTables singleton object.  Including the require\n   * statement included here causes a circular dependency condition that\n   * resulted in the UnitTables object not being defined for the Unit object.\n   * sigh.  Thanks, Paul, for figuring this out.\n   *\n   * @private\n   */\n  _getUnitTables() {\n    if (!UnitTables)\n      UnitTables = require('./unitTables.js').UnitTables;\n    return UnitTables.getInstance();\n  }\n\n} // end Unit class\n"],"mappings":";;;;;;AAYA,IAAAA,cAAA,GAAAC,sBAAA,CAAAC,OAAA;AAIA,IAAAC,SAAA,GAAAC,uBAAA,CAAAF,OAAA;AAAoD,SAAAG,yBAAA,eAAAC,OAAA,kCAAAC,KAAA,OAAAD,OAAA,IAAAD,wBAAA,YAAAA,CAAA,WAAAE,KAAA,YAAAA,KAAA;AAAA,SAAAH,wBAAAI,GAAA,QAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAD,KAAA,GAAAF,wBAAA,QAAAE,KAAA,IAAAA,KAAA,CAAAI,GAAA,CAAAH,GAAA,YAAAD,KAAA,CAAAK,GAAA,CAAAJ,GAAA,SAAAK,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAV,GAAA,QAAAO,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAb,GAAA,EAAAU,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAT,GAAA,EAAAU,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAV,GAAA,CAAAU,GAAA,SAAAL,MAAA,CAAAH,OAAA,GAAAF,GAAA,MAAAD,KAAA,IAAAA,KAAA,CAAAgB,GAAA,CAAAf,GAAA,EAAAK,MAAA,YAAAA,MAAA;AAAA,SAAAZ,uBAAAO,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAfpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIgB,IAAI,GAAGtB,OAAO,CAAC,aAAa,CAAC,CAACsB,IAAI;AACtC,IAAIC,SAAS,GAAGvB,OAAO,CAAC,gBAAgB,CAAC,CAACuB,SAAS;AAEnD,IAAIC,UAAU;AAEd,IAAIC,SAAS,GAAGzB,OAAO,CAAC,YAAY,CAAC;AAG9B,MAAM0B,IAAI,CAAC;EAEhB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,WAAWA,CAACC,KAAK,GAAG,CAAC,CAAC,EAAE;IAEtB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;AACJ;AACA;IACI,IAAI,CAACC,OAAO,GAAGD,KAAK,CAAC,SAAS,CAAC,IAAI,KAAK;;IAExC;AACJ;AACA;IACI,IAAI,CAACE,KAAK,GAAGF,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;;IAEjC;AACJ;AACA;IACI,IAAI,CAACG,OAAO,GAAGH,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE;;IAErC;AACJ;AACA;IACI,IAAI,CAACI,OAAO,GAAGJ,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE;;IAErC;AACJ;AACA;IACI,IAAI,CAACK,SAAS,GAAGL,KAAK,CAAC,WAAW,CAAC,IAAI,EAAE;;IAEzC;AACJ;AACA;AACA;AACA;AACA;AACA;IACI,IAAI,CAACM,UAAU,GAAGN,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC;;IAE1C;AACJ;AACA;IACI,IAAIA,KAAK,CAAC,MAAM,CAAC,KAAKO,SAAS,IAAIP,KAAK,CAAC,MAAM,CAAC,KAAK,IAAI,EAAE;MACzD,IAAI,CAACQ,IAAI,GAAG,IAAIb,SAAS,CAAC,CAAC;IAC7B;IACA;IACA;IAAA,KACK,IAAIK,KAAK,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,KAAKO,SAAS,EAAE;MAC/C,IAAI,CAACC,IAAI,GAAG,IAAIb,SAAS,CAACK,KAAK,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,CAAC;IACrD,CAAC,MACI,IAAIA,KAAK,CAAC,MAAM,CAAC,YAAYL,SAAS,EAAE;MAC3C,IAAI,CAACa,IAAI,GAAGR,KAAK,CAAC,MAAM,CAAC;IAC3B,CAAC,MACI,IAAIA,KAAK,CAAC,MAAM,CAAC,YAAYS,KAAK,IAAIZ,SAAS,CAACG,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE;MACnE,IAAI,CAACQ,IAAI,GAAG,IAAIb,SAAS,CAACK,KAAK,CAAC,MAAM,CAAC,CAAC;IAC1C,CAAC,MACI;MACH,IAAI,CAACQ,IAAI,GAAG,IAAIb,SAAS,CAAC,CAAC;IAC7B;IACA;AACJ;AACA;IACI,IAAI,CAACe,YAAY,GAAGV,KAAK,CAAC,cAAc,CAAC,IAAI,IAAI;;IAEjD;AACJ;AACA;IACI,IAAI,CAACW,MAAM,GAAGX,KAAK,CAAC,QAAQ,CAAC,IAAI,IAAI;;IAErC;AACJ;AACA;IACI,IAAI,CAACY,SAAS,GAAGZ,KAAK,CAAC,WAAW,CAAC,IAAI,KAAK;;IAE5C;AACJ;AACA;AACA;IACI,IAAI,CAACa,SAAS,GAAGb,KAAK,CAAC,WAAW,CAAC,IAAI,IAAI,CAAE,CAAE;;IAE/C;AACJ;AACA;IACI,IAAI,CAACc,IAAI,GAAGd,KAAK,CAAC,MAAM,CAAC,IAAI,IAAI;;IAEjC;AACJ;AACA;IACI,IAAI,CAACe,OAAO,GAAGf,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC;;IAEpC;AACJ;AACA;AACA;AACA;IACI,IAAI,CAACgB,UAAU,GAAGhB,KAAK,CAAC,YAAY,CAAC,IAAI,KAAK;;IAE9C;AACJ;AACA;IACI,IAAI,CAACiB,YAAY,GAAGjB,KAAK,CAAC,cAAc,CAAC,IAAI,KAAK;;IAElD;AACJ;AACA;AACA;AACA;AACA;AACA;IACI,IAAI,CAACkB,QAAQ,GAAGlB,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC;;IAEtC;AACJ;AACA;IACI,IAAI,CAACmB,cAAc,GAAGnB,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC;;IAElD;AACJ;AACA;AACA;AACA;AACA;AACA;IACI,IAAI,CAACoB,SAAS,GAAGpB,KAAK,CAAC,WAAW,CAAC,IAAI,IAAI;IAC3C,IAAI,CAACqB,OAAO,GAAGrB,KAAK,CAAC,SAAS,CAAC,IAAI,IAAI;IACvC,IAAI,CAACsB,cAAc,GAAGtB,KAAK,CAAC,gBAAgB,CAAC,IAAI,IAAI;IACrD,IAAI,CAACuB,SAAS,GAAGvB,KAAK,CAAC,WAAW,CAAC,IAAI,IAAI;IAC3C,IAAI,CAACwB,SAAS,GAAGxB,KAAK,CAAC,WAAW,CAAC,IAAI,IAAI;;IAE3C;AACJ;AACA;AACA;IACI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACI,IAAI,CAACyB,aAAa,GAAGzB,KAAK,CAAC,eAAe,CAAC,IAAI,IAAI;IACnD,IAAI,CAAC0B,aAAa,GAAG1B,KAAK,CAAC,eAAe,CAAC,IAAI,IAAI;;IAEnD;AACJ;AACA;AACA;IACI,IAAI,CAAC2B,cAAc,GAAG3B,KAAK,CAAC,gBAAgB,CAAC,IAAI,IAAI;IACrD,IAAI,CAAC4B,WAAW,GAAG5B,KAAK,CAAC,aAAa,CAAC,IAAI,IAAI;;IAE/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACI,IAAI,CAAC6B,SAAS,GAAG7B,KAAK,CAAC,WAAW,CAAC,IAAI,KAAK;EAG9C,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;EACE8B,WAAWA,CAAA,EAAG;IACZ,IAAI,CAAC5B,KAAK,GAAI,EAAE;IAChB,IAAI,CAACI,UAAU,GAAG,CAAC;IACnB,IAAI,CAAC,IAAI,CAACE,IAAI,EACZ,IAAI,CAACA,IAAI,GAAG,IAAIb,SAAS,CAAC,CAAC;IAC7B,IAAI,CAACa,IAAI,CAACuB,UAAU,CAAC,CAAC;IACtB,IAAI,CAACjB,IAAI,GAAG,IAAI;IAChB,IAAI,CAACC,OAAO,GAAG,CAAC;IAChB,OAAO,IAAI;EAEb,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEiB,UAAUA,CAACC,IAAI,EAAE;IACf,KAAK,IAAI7C,GAAG,IAAI6C,IAAI,EAAE;MACpB,IAAIC,IAAI,GAAG,CAAE9C,GAAG,CAAC+C,MAAM,CAAC/C,GAAG,CAACgD,MAAM,GAAG,CAAC,CAAE,KAAK,GAAG,GAAGhD,GAAG,GAAG,GAAG,GAAGA,GAAG;MAClE,IAAI,IAAI,CAACE,cAAc,CAAC4C,IAAI,CAAC,EAC3B,IAAI,CAACA,IAAI,CAAC,GAAGD,IAAI,CAAC7C,GAAG,CAAC,CAAC,KAEvB,MAAM,IAAIiD,KAAK,CAAE,oBAAmBjD,GAAI,8BAA6B,CAAC;IAC1E;EACF,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;EACEkD,KAAKA,CAAA,EAAG;IACN,IAAIC,OAAO,GAAG,IAAIzC,IAAI,CAAC,CAAC;IACxBb,MAAM,CAACuD,mBAAmB,CAAC,IAAI,CAAC,CAACC,OAAO,CAACC,GAAG,IAAI;MAC9C,IAAIA,GAAG,KAAK,MAAM,EAAE;QAClB,IAAI,IAAI,CAAC,MAAM,CAAC,EACdH,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAACD,KAAK,CAAC,CAAC,CAAC,KAEvCC,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI;MAC1B,CAAC,MAECA,OAAO,CAACG,GAAG,CAAC,GAAG,IAAI,CAACA,GAAG,CAAC;IAC5B,CAAC,CAAC;IACF,OAAOH,OAAO;EAEhB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;EACEI,MAAMA,CAACC,KAAK,EAAE;IACZ3D,MAAM,CAACuD,mBAAmB,CAACI,KAAK,CAAC,CAACH,OAAO,CAACC,GAAG,IAAI;MAC/C,IAAIA,GAAG,KAAK,MAAM,EAAE;QAClB,IAAIE,KAAK,CAAC,MAAM,CAAC,EACf,IAAI,CAAC,MAAM,CAAC,GAAGA,KAAK,CAAC,MAAM,CAAC,CAACN,KAAK,CAAC,CAAC,CAAC,KAErC,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI;MACvB,CAAC,MACI;QACH,IAAI,CAACI,GAAG,CAAC,GAAGE,KAAK,CAACF,GAAG,CAAC;MACxB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEG,MAAMA,CAACD,KAAK,EAAE;IAEZ,OAAQ,IAAI,CAACtC,UAAU,KAAKsC,KAAK,CAACtC,UAAU,IACpC,IAAI,CAACQ,IAAI,KAAK8B,KAAK,CAAC9B,IAAI,IACxB,IAAI,CAACC,OAAO,KAAK6B,KAAK,CAAC7B,OAAO,KAC5B,IAAI,CAACP,IAAI,KAAK,IAAI,IAAIoC,KAAK,CAACpC,IAAI,KAAK,IAAI,IAC1C,IAAI,CAACA,IAAI,CAACqC,MAAM,CAACD,KAAK,CAACpC,IAAI,CAAC,CAAC;EAExC,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;EACEsC,UAAUA,CAACF,KAAK,EAAE;IAEhB,IAAIG,QAAQ,GAAG9D,MAAM,CAAC+D,IAAI,CAAC,IAAI,CAAC,CAACC,IAAI,CAAC,CAAC;IACvC,IAAIC,MAAM,GAAGjE,MAAM,CAAC+D,IAAI,CAACJ,KAAK,CAAC,CAACK,IAAI,CAAC,CAAC;IAEtC,IAAIE,MAAM,GAAGJ,QAAQ,CAACX,MAAM;IAC5B,IAAIgB,KAAK,GAAID,MAAM,KAAKD,MAAM,CAACd,MAAO;;IAEtC;IACA;IACA,KAAK,IAAIiB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,MAAM,IAAIC,KAAK,EAAEC,CAAC,EAAE,EAAE;MACxC,IAAIN,QAAQ,CAACM,CAAC,CAAC,KAAKH,MAAM,CAACG,CAAC,CAAC,EAAE;QAC7B,IAAIN,QAAQ,CAACM,CAAC,CAAC,KAAK,MAAM,EACxBD,KAAK,GAAG,IAAI,CAAC5C,IAAI,CAACqC,MAAM,CAACD,KAAK,CAACpC,IAAI,CAAC,CAAC,KAErC4C,KAAK,GAAG,IAAI,CAACL,QAAQ,CAACM,CAAC,CAAC,CAAC,KAAKT,KAAK,CAACG,QAAQ,CAACM,CAAC,CAAC,CAAC;MACpD,CAAC,MAECD,KAAK,GAAG,KAAK;IACjB,CAAC,CAAC;IACF,OAAOA,KAAK;EACd,CAAC;;EAGD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEE,WAAWA,CAACC,YAAY,EAAE;IACxB,IAAIC,KAAK,GAAGD,YAAY,CAACpB,MAAM,CAACoB,YAAY,CAACnB,MAAM,GAAG,CAAC,CAAC,KAAK,GAAG,GAAGmB,YAAY,GACtCA,YAAY,GAAG,GAAG;IAC3D,OAAO,IAAI,CAACC,KAAK,CAAC;EAEpB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,WAAWA,CAACC,GAAG,EAAEC,QAAQ,EAAE;IACzB,IAAIC,MAAM,GAAG,GAAG;IAEhB,IAAI,IAAI,CAAC3C,YAAY,EACnB,MAAO,IAAIoB,KAAK,CAAE,yCAAwC,IAAI,CAAClC,OAAQ,GAAE,CAAC;IAC5E,IAAIwD,QAAQ,CAAC1C,YAAY,EACvB,MAAO,IAAIoB,KAAK,CAAE,sCAAqCsB,QAAQ,CAACxD,OAAQ,GAAE,CAAC;;IAE7E;IACA,IAAIwD,QAAQ,CAACnD,IAAI,IAAI,IAAI,CAACA,IAAI,IAAI,CAAEmD,QAAQ,CAACnD,IAAI,CAACqC,MAAM,CAAC,IAAI,CAACrC,IAAI,CAAE,EAAE;MACpE;MACA,IAAI,IAAI,CAACqD,sBAAsB,CAACF,QAAQ,CAAC,EAAE;QACzC,MAAM,IAAItB,KAAK,CAAC3C,IAAI,CAACoE,kBAAkB,CAAC;MAC1C,CAAC,MACI;QACH,MAAM,IAAIzB,KAAK,CAAE,WAAUsB,QAAQ,CAACxD,OAAQ,uBAAsB,GAC/D,MAAK,IAAI,CAACA,OAAQ,GAAE,CAAC;MAC1B;IACF;IACA;IACA,IAAIwD,QAAQ,CAACnD,IAAI,KAAK,CAAC,IAAI,CAACA,IAAI,IAAI,IAAI,CAACA,IAAI,CAACuD,MAAM,CAAC,CAAC,CAAC,EAAE;MACvD,MAAM,IAAI1B,KAAK,CAAE,WAAUsB,QAAQ,CAACxD,OAAQ,uBAAsB,GAC/D,MAAK,IAAI,CAACA,OAAQ,GAAE,CAAC;IAC1B;;IAEA;IACA,IAAI,IAAI,CAACK,IAAI,KAAK,CAACmD,QAAQ,CAACnD,IAAI,IAAImD,QAAQ,CAACnD,IAAI,CAACuD,MAAM,CAAC,CAAC,CAAC,EAAE;MAC3D,MAAM,IAAI1B,KAAK,CAAE,WAAUsB,QAAQ,CAACxD,OAAQ,uBAAsB,GAC/D,MAAK,IAAI,CAACA,OAAQ,GAAE,CAAC;IAC1B;IAEA,IAAI6D,OAAO,GAAGL,QAAQ,CAAC7C,IAAI;IAC3B,IAAImD,OAAO,GAAGN,QAAQ,CAACrD,UAAU;IAEjC,IAAI4D,CAAC;IACL,IAAIF,OAAO,IAAI,IAAI,EAAE;MACnB;MACA;MACA,IAAIG,QAAQ,GAAGC,sBAAK,CAACC,OAAO,CAACL,OAAO,CAAC;MACrCE,CAAC,GAAGC,QAAQ,CAACG,OAAO,CAACZ,GAAG,GAAGC,QAAQ,CAAC5C,OAAO,CAAC,GAAGkD,OAAO;MACtD;IACF,CAAC,MACI;MACHC,CAAC,GAAGR,GAAG,GAAGO,OAAO;IACnB;IAEA,IAAI,IAAI,CAACnD,IAAI,IAAI,IAAI,EAAE;MACrB;MACA;MACA,IAAIyD,MAAM,GAAGH,sBAAK,CAACC,OAAO,CAAC,IAAI,CAACvD,IAAI,CAAC;MACrC8C,MAAM,GAAGW,MAAM,CAACC,KAAK,CAACN,CAAC,GAAG,IAAI,CAAC5D,UAAU,CAAC,GAAG,IAAI,CAACS,OAAO;IAC3D,CAAC,MACI;MACH6C,MAAM,GAAGM,CAAC,GAAG,IAAI,CAAC5D,UAAU;IAC9B;IAEA,OAAOsD,MAAM;EAEf,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEa,SAASA,CAACf,GAAG,EAAEgB,MAAM,EAAE;IAErB,OAAOA,MAAM,CAACjB,WAAW,CAACC,GAAG,EAAE,IAAI,CAAC;EAEtC,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEiB,eAAeA,CAACjB,GAAG,EAAE;IAEnB;IACA,IAAG,IAAI,CAAC5C,IAAI,KAAK,IAAI,EACnB4C,GAAG,GAAG,IAAI,CAAC5C,IAAI,CAAC8D,MAAM,CAAClB,GAAG,GAAG,IAAI,CAAC3C,OAAO,CAAC,GAAG,IAAI,CAACT,UAAU;IAE9D,OAAOoD,GAAG;EAEZ,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEmB,cAAcA,CAACnB,GAAG,EAAE;IAElB;IACAA,GAAG,GAAG,IAAI,CAACiB,eAAe,CAACjB,GAAG,CAAC;;IAE/B;IACA,IAAI,CAACpD,UAAU,GAAG,CAAC;IACnB,IAAI,CAACQ,IAAI,GAAG,IAAI;IAChB,IAAI,CAACC,OAAO,GAAG,CAAC;IAChB,IAAI,CAACb,KAAK,GAAG,EAAE;;IAEf;IACA;IACA;IACA;IACA,KAAK,IAAI4E,CAAC,GAAG,CAAC,EAAEC,GAAG,GAAGpF,SAAS,CAACqF,MAAM,CAAC,CAAC,EAAEF,CAAC,GAAGC,GAAG,EAAED,CAAC,EAAE,EAAE;MACtD,IAAIG,IAAI,GAAG,IAAI,CAACzE,IAAI,CAAC0E,YAAY,CAACJ,CAAC,CAAC;MACpC,IAAIK,IAAI,GAAG,IAAI,CAACC,cAAc,CAAC,CAAC;MAChC,IAAIC,EAAE,GAAGF,IAAI,CAACG,mBAAmB,CAAC,IAAI3F,SAAS,CAACmF,CAAC,CAAC,CAAC;MACnD,IAAGO,EAAE,IAAI,IAAI,EACX,MAAM,IAAIhD,KAAK,CAAE,sCAAqCyC,CAAE,EAAC,CAAC;MAC5D,IAAI,CAAC5E,KAAK,GAAGmF,EAAE,CAACE,IAAI,GAAGN,IAAI;IAC7B;IACA,OAAOvB,GAAG;EAEZ,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE8B,cAAcA,CAACC,GAAG,EAAEf,MAAM,EAAEgB,eAAe,EAAE;IAC3C;IACA;IACA;;IAEA;IACA;IACA;IACA,MAAMC,kBAAkB,GAAI,IAAI,CAACzE,QAAQ,GAAGwD,MAAM,CAACxD,QAAQ;IAC3D;IACA;IACA;IACA,IAAIiE,IAAI,GAAG,IAAI,CAACC,cAAc,CAAC,CAAC;IAChC,IAAIQ,MAAM,GAAGT,IAAI,CAACU,aAAa,CAAC,KAAK,CAAC,CAACvF,UAAU;IACjD;IACA;IACA;IACA;IACA,IAAIwF,cAAc,GAAGC,IAAI,CAACC,GAAG,CAACN,eAAe,GAACE,MAAM,EAAED,kBAAkB,CAAC;IACzE;IACA;IACA,OAAO,IAAI,CAACrF,UAAU,GAACoE,MAAM,CAACpE,UAAU,GAAGwF,cAAc,GAAGL,GAAG;EACjE,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEQ,aAAaA,CAACR,GAAG,EAAEf,MAAM,EAAEgB,eAAe,EAAEQ,MAAM,EAAE;IAClD;IACA;IACA;IACA;IACA;IACA,MAAMC,mBAAmB,GAAIzB,MAAM,CAACvD,cAAc,GAAG,IAAI,CAACA,cAAc;IACxE;IACA,IAAIiF,cAAc,GAAGV,eAAe,GAAGQ,MAAM;IAC7C;IACA,IAAIG,cAAc,GAAI,IAAI,CAACjB,cAAc,CAAC,CAAC,CAACS,aAAa,CAAC,KAAK,CAAC,CAACvF,UAAU;IAC3E;IACA;IACA,IAAIgG,WAAW,GAAG,IAAI,CAAChG,UAAU,GAAGmF,GAAG,GAAGM,IAAI,CAACC,GAAG,CAACI,cAAc,EAAED,mBAAmB,CAAC;IACvF;IACA;IACA;IACA,IAAII,UAAU,GAAG7B,MAAM,CAACpE,UAAU,GAAGyF,IAAI,CAACC,GAAG,CAACK,cAAc,EAAEF,mBAAmB,CAAC;IAClF;IACA,IAAIK,mBAAmB,GAAGF,WAAW,GAAGC,UAAU;IAClD;IACA,OAAOC,mBAAmB;EAC5B,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,gBAAgBA,CAAChB,GAAG,EAAEf,MAAM,EAAEgB,eAAe,EAAEQ,MAAM,EAAE;IACrD;IACA;IACA;IACA;IACA;IACA;IACA,MAAMQ,iBAAiB,GAAI,IAAI,CAACvF,cAAc,GAAGuD,MAAM,CAACvD,cAAc;IACtE,MAAMwF,MAAM,GAAGlB,GAAG,GAAGM,IAAI,CAACC,GAAG,CAACE,MAAM,EAAEQ,iBAAiB,CAAC;IACxD;IACA;IACA;IACA;IACA,MAAMvB,IAAI,GAAG,IAAI,CAACC,cAAc,CAAC,CAAC;IAClC,MAAMwB,CAAC,GAAGzB,IAAI,CAAC0B,qBAAqB,CAAC,CAAC;IACtC,MAAMV,mBAAmB,GAAG,IAAI,CAAC3F,IAAI,CAAC0E,YAAY,CAAC0B,CAAC,CAAC,GAAGlC,MAAM,CAAClE,IAAI,CAAC0E,YAAY,CAAC0B,CAAC,CAAC;IACnF,MAAMjB,kBAAkB,GAAG,CAACQ,mBAAmB,CAAC,CAAC;IACjD,MAAMP,MAAM,GAAGT,IAAI,CAACU,aAAa,CAAC,KAAK,CAAC,CAACvF,UAAU;IACnD,IAAIwF,cAAc,GAAGC,IAAI,CAACC,GAAG,CAACN,eAAe,GAACE,MAAM,EAAED,kBAAkB,CAAC;IACzE,OAAO,IAAI,CAACrF,UAAU,GAACoE,MAAM,CAACpE,UAAU,GAAGwF,cAAc,GAAGa,MAAM;EACpE;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEG,gBAAgBA,CAAA,EAAG;IACjB,OAAO,IAAI,CAAC3F,cAAc,KAAK,CAAC;EAClC,CAAC,CAAC;;EAEF;AACF;AACA;AACA;AACA;EACE4F,WAAWA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC7F,QAAQ,KAAK,CAAC;EAC5B,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEE8F,YAAYA,CAACvB,GAAG,EAAEf,MAAM,EAAEwB,MAAM,EAAE;IAChC;IACA;IACA;IACA,MAAMQ,iBAAiB,GAAI,IAAI,CAACvF,cAAc,GAAGuD,MAAM,CAACvD,cAAc;;IAEtE;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA,OAAOsE,GAAG,IAAI,IAAI,CAACnF,UAAU,GAAGoE,MAAM,CAACpE,UAAU,CAAC,GAAGyF,IAAI,CAACC,GAAG,CAACE,MAAM,EAAEQ,iBAAiB,CAAC;EAC1F,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEO,WAAWA,CAACvD,GAAG,EAAE;IACf,IAAI,IAAI,CAAC5C,IAAI,IAAI,IAAI,EACnB,OAAO,IAAI,CAAC+D,cAAc,CAACnB,GAAG,CAAC,CAAC,KAEhC,OAAOA,GAAG;EAEd,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEwD,YAAYA,CAACC,CAAC,EAAE;IAEd,IAAI5E,OAAO,GAAG,IAAI,CAACD,KAAK,CAAC,CAAC;IAC1B,IAAIC,OAAO,CAACzB,IAAI,IAAI,IAAI,EACtByB,OAAO,CAACxB,OAAO,IAAIoG,CAAC,CAAC,KAErB5E,OAAO,CAACjC,UAAU,IAAI6G,CAAC;IACzB,IAAIC,MAAM,GAAGD,CAAC,CAACE,QAAQ,CAAC,CAAC;IACzB9E,OAAO,CAACrC,KAAK,GAAG,IAAI,CAACoH,WAAW,CAACF,MAAM,EAAE,GAAG,EAAE,IAAI,CAAClH,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC;IACnEqC,OAAO,CAACpC,OAAO,GAAG,IAAI,CAACmH,WAAW,CAACF,MAAM,EAAE,GAAG,EAAE,IAAI,CAACjH,OAAO,EAAE,GAAG,EAAE,GAAG,CAAC;IACvEoC,OAAO,CAACnC,OAAO,GAAG,IAAI,CAACkH,WAAW,CAACF,MAAM,EAAE,GAAG,EAAE,IAAI,CAAChH,OAAO,EAAE,GAAG,EAAE,GAAG,CAAC;IACvEmC,OAAO,CAAC7B,YAAY,GAAG,IAAI,CAAC4G,WAAW,CAACF,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC1G,YAAY,EAClE,GAAG,EAAE,GAAG,CAAC;IAEb,OAAO6B,OAAO;EAEhB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEgF,aAAaA,CAAC3E,KAAK,EAAE;IAEnB,IAAIL,OAAO,GAAG,IAAI,CAACD,KAAK,CAAC,CAAC;IAE1B,IAAIC,OAAO,CAACzB,IAAI,IAAI,IAAI,EAAE;MACxB,IAAI8B,KAAK,CAAC9B,IAAI,IAAI,IAAI,KAAK,CAAC8B,KAAK,CAACpC,IAAI,IAAIoC,KAAK,CAACpC,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAC,EAC5DjF,OAAO,CAACxB,OAAO,IAAI6B,KAAK,CAACtC,UAAU,CAAC,KAEpC,MAAO,IAAI+B,KAAK,CAAE,sCAAqCE,OAAO,CAACrC,KAAM,GAAE,GACrE,SAAS,CAAC;IAChB,CAAC,CAAC;IAAA,KAEG,IAAI0C,KAAK,CAAC9B,IAAI,IAAI,IAAI,EAAE;MAC3B,IAAI,CAACyB,OAAO,CAAC/B,IAAI,IAAI+B,OAAO,CAAC/B,IAAI,CAACgH,MAAM,CAAC,CAAC,EAAE;QAC1CjF,OAAO,CAACxB,OAAO,GAAG6B,KAAK,CAAC7B,OAAO,GAAGwB,OAAO,CAACjC,UAAU;QACpDiC,OAAO,CAACjC,UAAU,GAAGsC,KAAK,CAACtC,UAAU;QACrCiC,OAAO,CAACzB,IAAI,GAAG8B,KAAK,CAAC9B,IAAI;MAC3B,CAAC,MAEC,MAAO,IAAIuB,KAAK,CAAE,sCAAqCO,KAAK,CAAC1C,KAAM,EAAC,CAAC;IACzE,CAAC,CAAC;;IAEF;IAAA,KACK;MACHqC,OAAO,CAACjC,UAAU,IAAIsC,KAAK,CAACtC,UAAU;IACxC,CAAC,CAAC;;IAEF;IACA;IACA,IAAI,CAACiC,OAAO,CAAC/B,IAAI,IAAK+B,OAAO,CAAC/B,IAAI,IAAI,CAAC+B,OAAO,CAAC/B,IAAI,CAACiH,OAAQ,EAAE;MAC5D,IAAI7E,KAAK,CAACpC,IAAI,EACZ+B,OAAO,CAAC/B,IAAI,GAAGoC,KAAK,CAACpC,IAAI,CAAC8B,KAAK,CAAC,CAAC,CAAC,KAElCC,OAAO,CAAC/B,IAAI,GAAGoC,KAAK,CAACpC,IAAI;IAC7B;IACA;IACA;IAAA,KACK,IAAIoC,KAAK,CAACpC,IAAI,IAAIoC,KAAK,CAACpC,IAAI,YAAYb,SAAS,EAAE;MACtD4C,OAAO,CAAC/B,IAAI,CAACkH,GAAG,CAAC9E,KAAK,CAACpC,IAAI,CAAC;IAC9B;;IAEA;IACA+B,OAAO,CAACpB,cAAc,IAAIyB,KAAK,CAACzB,cAAc;IAC9CoB,OAAO,CAACrB,QAAQ,IAAI0B,KAAK,CAAC1B,QAAQ;;IAElC;IACA;IACAqB,OAAO,CAACrC,KAAK,GAAG,IAAI,CAACoH,WAAW,CAAC/E,OAAO,CAACrC,KAAK,EAAE,GAAG,EAAE0C,KAAK,CAAC1C,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC;IAC3EqC,OAAO,CAACpC,OAAO,GAAG,IAAI,CAACmH,WAAW,CAAC/E,OAAO,CAACpC,OAAO,EAAE,GAAG,EAAEyC,KAAK,CAACzC,OAAO,EACpE,GAAG,EAAE,GAAG,CAAC;IACX,IAAIoC,OAAO,CAACnC,OAAO,IAAIwC,KAAK,CAACxC,OAAO,EAClCmC,OAAO,CAACnC,OAAO,GAAG,IAAI,CAACkH,WAAW,CAAC/E,OAAO,CAACnC,OAAO,EAAE,GAAG,EAAEwC,KAAK,CAACxC,OAAO,EACpE,GAAG,EAAE,GAAG,CAAC,CAAC,KACT,IAAIwC,KAAK,CAACxC,OAAO,EACpBmC,OAAO,CAACnC,OAAO,GAAGwC,KAAK,CAACxC,OAAO;IACjCmC,OAAO,CAACoF,yBAAyB,CAAC,CAAC;IACnC,IAAIpF,OAAO,CAAC7B,YAAY,IAAIkC,KAAK,CAAClC,YAAY,EAC5C6B,OAAO,CAAC7B,YAAY,GAAG,IAAI,CAAC4G,WAAW,CAAC/E,OAAO,CAAC7B,YAAY,EAAE,GAAG,EAC/DkC,KAAK,CAAClC,YAAY,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,KAC7B,IAAIkC,KAAK,CAAClC,YAAY,EACzB6B,OAAO,CAAC7B,YAAY,GAAGkC,KAAK,CAAClC,YAAY;;IAE3C;IACA;IACA;IACA;IACA,IAAI,CAAC6B,OAAO,CAACtB,YAAY,EACvBsB,OAAO,CAACtB,YAAY,GAAG2B,KAAK,CAAC3B,YAAY;;IAE3C;IACA,IAAI,CAACsB,OAAO,CAACvB,UAAU,EACrBuB,OAAO,CAACvB,UAAU,GAAG4B,KAAK,CAAC5B,UAAU;IAEvC,OAAOuB,OAAO;EAEhB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;EACEoF,yBAAyBA,CAAA,EAAG;IAC1B,IAAI,CAACnG,SAAS,GAAG,EAAE;IACnB,IAAI,CAACJ,SAAS,GAAG,IAAI;IACrB,IAAI,CAACnB,OAAO,GAAG,KAAK;EACtB;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE2H,MAAMA,CAAChF,KAAK,EAAE;IAEZ,IAAIL,OAAO,GAAG,IAAI,CAACD,KAAK,CAAC,CAAC;IAE1B,IAAIC,OAAO,CAACzB,IAAI,IAAI,IAAI,EACtB,MAAO,IAAIuB,KAAK,CAAE,oCAAmCE,OAAO,CAACrC,KAAM,EAAC,CAAC;IACvE,IAAI0C,KAAK,CAAC9B,IAAI,IAAI,IAAI,EACpB,MAAO,IAAIuB,KAAK,CAAE,uCAAsCO,KAAK,CAAC1C,KAAM,EAAC,CAAC;IAExE,IAAIqC,OAAO,CAACrC,KAAK,IAAI0C,KAAK,CAAC1C,KAAK,EAC9BqC,OAAO,CAACrC,KAAK,GAAG,IAAI,CAACoH,WAAW,CAAC/E,OAAO,CAACrC,KAAK,EAAE,GAAG,EAAE0C,KAAK,CAAC1C,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,KACzE,IAAI0C,KAAK,CAAC1C,KAAK,EAClBqC,OAAO,CAACrC,KAAK,GAAG0C,KAAK,CAACiF,YAAY,CAACjF,KAAK,CAAC1C,KAAK,CAAC;IAEjDqC,OAAO,CAACpC,OAAO,GAAG,IAAI,CAACmH,WAAW,CAAC/E,OAAO,CAACpC,OAAO,EAAE,GAAG,EAAEyC,KAAK,CAACzC,OAAO,EACpE,GAAG,EAAE,GAAG,CAAC;IAEX,IAAIoC,OAAO,CAACnC,OAAO,IAAIwC,KAAK,CAACxC,OAAO,EAClCmC,OAAO,CAACnC,OAAO,GAAG,IAAI,CAACkH,WAAW,CAAC/E,OAAO,CAACnC,OAAO,EAAE,GAAG,EAAEwC,KAAK,CAACxC,OAAO,EACtE,GAAG,EAAE,GAAG,CAAC,CAAC,KACP,IAAIwC,KAAK,CAACxC,OAAO,EACpBmC,OAAO,CAACnC,OAAO,GAAGwC,KAAK,CAACiF,YAAY,CAACjF,KAAK,CAACxC,OAAO,CAAC;IAErDmC,OAAO,CAACoF,yBAAyB,CAAC,CAAC;IAEnCpF,OAAO,CAACjC,UAAU,IAAIsC,KAAK,CAACtC,UAAU;IAEtC,IAAIiC,OAAO,CAAC7B,YAAY,IAAIkC,KAAK,CAAClC,YAAY,EAC5C6B,OAAO,CAAC7B,YAAY,GAAG,IAAI,CAAC4G,WAAW,CAAC/E,OAAO,CAAC7B,YAAY,EAAE,GAAG,EAC/DkC,KAAK,CAAClC,YAAY,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,KAC7B,IAAIkC,KAAK,CAAClC,YAAY,EACzB6B,OAAO,CAAC7B,YAAY,GAAGkC,KAAK,CAACiF,YAAY,CAACjF,KAAK,CAAClC,YAAY,CAAC;;IAE/D;IACA;IACA;IACA;IACA,IAAIkC,KAAK,CAACpC,IAAI,EAAE;MACd,IAAI+B,OAAO,CAAC/B,IAAI,EAAE;QAChB,IAAI+B,OAAO,CAAC/B,IAAI,CAACuD,MAAM,CAAC,CAAC,EACvBxB,OAAO,CAAC/B,IAAI,CAACuB,UAAU,CAAC,CAAC;QAC3BQ,OAAO,CAAC/B,IAAI,GAAG+B,OAAO,CAAC/B,IAAI,CAACsH,GAAG,CAAClF,KAAK,CAACpC,IAAI,CAAC;MAC7C,CAAC,CAAC;;MAEF;MACA;MAAA,KAEE+B,OAAO,CAAC/B,IAAI,GAAGoC,KAAK,CAACpC,IAAI,CAAC8B,KAAK,CAAC,CAAC,CAACyF,KAAK,CAAC,CAAC;IAC7C,CAAC,CAAC;;IAEF;IACA;IACAxF,OAAO,CAACrB,QAAQ,IAAI0B,KAAK,CAAC1B,QAAQ;IAClC;IACAqB,OAAO,CAACpB,cAAc,IAAIyB,KAAK,CAACzB,cAAc;;IAE9C;IACA;IACA;IACA;IACA,IAAI,CAACoB,OAAO,CAACtB,YAAY,EACvBsB,OAAO,CAACtB,YAAY,GAAG2B,KAAK,CAAC3B,YAAY;IAE3C,OAAOsB,OAAO;EAEhB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEyF,MAAMA,CAAA,EAAG;IACP,IAAIzF,OAAO,GAAG,IAAI,CAACD,KAAK,CAAC,CAAC;IAC1B,IAAI,IAAI,CAACxB,IAAI,IAAI,IAAI,EACnB,MAAO,IAAIuB,KAAK,CAAE,wCAAuC,IAAI,CAACnC,KAAM,EAAC,CAAC;IAExEqC,OAAO,CAACrC,KAAK,GAAG,IAAI,CAAC2H,YAAY,CAAC,IAAI,CAAC3H,KAAK,CAAC;IAC7CqC,OAAO,CAACjC,UAAU,GAAG,CAAC,GAAC,IAAI,CAACA,UAAU;IACtCiC,OAAO,CAAC/B,IAAI,CAACuH,KAAK,CAAC,CAAC;;IAEpB;IACAxF,OAAO,CAACpB,cAAc,GAAG,CAAC,IAAI,CAACA,cAAc;IAC7CoB,OAAO,CAACrB,QAAQ,GAAG,CAAC,IAAI,CAACA,QAAQ;IAEjC,OAAOqB,OAAO;EAEhB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEsF,YAAYA,CAACI,SAAS,EAAE;IAEtB,IAAIA,SAAS,CAAC7F,MAAM,GAAG,CAAC,EAAE;MACxB;MACA,IAAI8F,SAAS,GAAGD,SAAS,CAACE,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAACA,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC;MACnG,QAAOD,SAAS,CAAC/F,MAAM,CAAC,CAAC,CAAC;QACxB,KAAK,GAAG;UAAG8F,SAAS,GAAGC,SAAS,CAACE,MAAM,CAAC,CAAC,CAAC;UAAE;QAC5C,KAAK,GAAG;UAAGH,SAAS,GAAGC,SAAS;UAAE;QAClC;UAAWD,SAAS,GAAG,GAAG,GAAGC,SAAS;MACxC;IACF;IACA,OAAOD,SAAS;EAElB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEX,WAAWA,CAACe,IAAI,EAAEC,QAAQ,EAAEC,IAAI,EAAEC,SAAS,EAAEC,OAAO,EAAE;IAEpD,OAAO,IAAI,CAACC,eAAe,CAACL,IAAI,EAAEG,SAAS,EAAEC,OAAO,CAAC,GACnDH,QAAQ,GAAG,IAAI,CAACI,eAAe,CAACH,IAAI,EAAEC,SAAS,EAAEC,OAAO,CAAC;EAC7D;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,eAAeA,CAACC,GAAG,EAAEH,SAAS,EAAEC,OAAO,EAAE;IACvC,IAAIG,GAAG,GAAG,EAAE;IACZ,IAAIvK,SAAS,CAACwK,eAAe,CAACF,GAAG,CAAC,EAAE;MAClCC,GAAG,GAAGD,GAAG;IACX,CAAC,MACI;MACH,IAAIA,GAAG,CAACxG,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,IAAIwG,GAAG,CAACG,QAAQ,CAAC,GAAG,CAAC,IAAIH,GAAG,CAACxG,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,IAAKwG,GAAG,CAACG,QAAQ,CAAC,GAAG,CAAC,EAAE;QAC7FF,GAAG,GAAGD,GAAG;MACX,CAAC,MACI,IAAI,QAAQ,CAACI,IAAI,CAACJ,GAAG,CAAC,EAAE;QAC3BC,GAAG,GAAGJ,SAAS,GAAGG,GAAG,GAAGF,OAAO;MACjC,CAAC,MACI;QACHG,GAAG,GAAGD,GAAG;MACX;IACF;IACA,OAAOC,GAAG;EACZ;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEI,KAAKA,CAACC,CAAC,EAAE;IAEP,IAAI,IAAI,CAACnI,IAAI,IAAI,IAAI,EACnB,MAAO,IAAIuB,KAAK,CAAE,sCAAqC,IAAI,CAACnC,KAAM,IAAG,GACpD,aAAa,CAAC;IAEjC,IAAIqC,OAAO,GAAG,IAAI,CAACD,KAAK,CAAC,CAAC;IAC1B;IACA;IACA;IACA;IACA,IAAI4G,IAAI,GAAG,IAAI,CAAC/I,OAAO;IACvB,IAAIgJ,MAAM,GAAGD,IAAI,CAAC9F,KAAK,CAAC,gBAAgB,CAAC;IACzC,IAAIgG,KAAK,GAAGD,MAAM,CAAC/G,MAAM;IAEzB,KAAK,IAAI0C,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsE,KAAK,EAAEtE,CAAC,EAAE,EAAE;MAC9B,IAAIuE,EAAE,GAAGF,MAAM,CAACrE,CAAC,CAAC;MAClB,IAAIuE,EAAE,KAAK,GAAG,IAAIA,EAAE,KAAK,GAAG,EAAE;QAC5B,IAAIC,GAAG,GAAGC,QAAQ,CAACF,EAAE,CAAC;QACtB,IAAIxJ,SAAS,CAACyJ,GAAG,CAAC,EAChBH,MAAM,CAACrE,CAAC,CAAC,GAAIiB,IAAI,CAACC,GAAG,CAACsD,GAAG,EAAEL,CAAC,CAAC,CAAC5B,QAAQ,CAAC,CAAE,CAAC,KACvC;UACH,IAAImC,IAAI,GAAGH,EAAE,CAACjH,MAAM;UACpB,KAAK,IAAIqH,CAAC,GAAGD,IAAI,GAAG,CAAC,EAAEC,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;YAClC,IAAIC,KAAK,GAAGH,QAAQ,CAACF,EAAE,CAACI,CAAC,CAAC,CAAC;YAC3B,IAAI,CAAC5J,SAAS,CAAC6J,KAAK,CAAC,EAAE;cACrB,IAAIL,EAAE,CAACI,CAAC,CAAC,KAAK,GAAG,IAAIJ,EAAE,CAACI,CAAC,CAAC,KAAK,GAAG,EAAE;gBAClCA,CAAC,EAAE;cACL;cACA,IAAIA,CAAC,GAAGD,IAAI,GAAG,CAAC,EAAE;gBAChB,IAAIG,GAAG,GAAGJ,QAAQ,CAACF,EAAE,CAACjB,MAAM,CAACqB,CAAC,CAAC,CAAC;gBAChCE,GAAG,GAAG5D,IAAI,CAACC,GAAG,CAAC2D,GAAG,EAAEV,CAAC,CAAC;gBACtBE,MAAM,CAACrE,CAAC,CAAC,GAAGuE,EAAE,CAACjB,MAAM,CAAC,CAAC,EAAEqB,CAAC,CAAC,GAAGE,GAAG,CAACtC,QAAQ,CAAC,CAAC;gBAC5CoC,CAAC,GAAG,CAAC,CAAC;cACR,CAAC,MACI;gBACHN,MAAM,CAACrE,CAAC,CAAC,IAAImE,CAAC,CAAC5B,QAAQ,CAAC,CAAC;gBACzBoC,CAAC,GAAG,CAAC,CAAC;cACR,CAAC,CAAC;cACFA,CAAC,GAAG,CAAC,CAAC;YACR,CAAC,CAAC;UACJ,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC;;IAEF;IACAlH,OAAO,CAACpC,OAAO,GAAGgJ,MAAM,CAACS,IAAI,CAAC,EAAE,CAAC;IAEjCrH,OAAO,CAACjC,UAAU,GAAGyF,IAAI,CAACC,GAAG,CAAC,IAAI,CAAC1F,UAAU,EAAE2I,CAAC,CAAC;IACjD,IAAI1G,OAAO,CAAC/B,IAAI,EAAE;MAChB+B,OAAO,CAAC/B,IAAI,CAACqJ,GAAG,CAACZ,CAAC,CAAC;IACrB;;IAEA;IACA1G,OAAO,CAACpB,cAAc,IAAI8H,CAAC;IAC3B1G,OAAO,CAACrB,QAAQ,IAAI+H,CAAC;IAErB,OAAO1G,OAAO;EAEhB,CAAC,CAAC;;EAGF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEsB,sBAAsBA,CAACjB,KAAK,EAAE;IAC5B,IAAIuC,IAAI,GAAG,IAAI,CAACC,cAAc,CAAC,CAAC;IAChC,IAAIwB,CAAC,GAAGzB,IAAI,CAAC0B,qBAAqB,CAAC,CAAC;IACpC;IACA;IACA,MAAMiD,QAAQ,GAAG,IAAI,CAACtJ,IAAI,CAAC8B,KAAK,CAAC,CAAC;IAClCwH,QAAQ,CAACC,YAAY,CAACnD,CAAC,EAAGkD,QAAQ,CAAC5E,YAAY,CAAC0B,CAAC,CAAC,GAAG,IAAI,CAAC1F,QAAS,CAAC;IACpE,MAAM8I,QAAQ,GAAGpH,KAAK,CAACpC,IAAI,CAAC8B,KAAK,CAAC,CAAC;IACnC0H,QAAQ,CAACD,YAAY,CAACnD,CAAC,EAAGoD,QAAQ,CAAC9E,YAAY,CAAC0B,CAAC,CAAC,GAAGhE,KAAK,CAAC1B,QAAS,CAAC;IACrE,OAAQ4I,QAAQ,CAACjH,MAAM,CAACmH,QAAQ,CAAC;EACnC;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,qBAAqBA,CAACrH,KAAK,EAAE;IAC3B,IAAIuC,IAAI,GAAG,IAAI,CAACC,cAAc,CAAC,CAAC;IAChC,IAAIwB,CAAC,GAAGzB,IAAI,CAAC0B,qBAAqB,CAAC,CAAC;IACpC;IACA;IACA,MAAMiD,QAAQ,GAAG,IAAI,CAACtJ,IAAI,CAAC8B,KAAK,CAAC,CAAC;IAClCwH,QAAQ,CAACC,YAAY,CAACnD,CAAC,EAAGkD,QAAQ,CAAC5E,YAAY,CAAC0B,CAAC,CAAC,GAAG,IAAI,CAACzF,cAAe,CAAC;IAC1E,MAAM6I,QAAQ,GAAGpH,KAAK,CAACpC,IAAI,CAAC8B,KAAK,CAAC,CAAC;IACnC0H,QAAQ,CAACD,YAAY,CAACnD,CAAC,EAAGoD,QAAQ,CAAC9E,YAAY,CAAC0B,CAAC,CAAC,GAAGhE,KAAK,CAACzB,cAAe,CAAC;IAC3E,OAAQ2I,QAAQ,CAACjH,MAAM,CAACmH,QAAQ,CAAC;EACnC;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEE,oBAAoBA,CAACtH,KAAK,EAAE;IAC1B,MAAMuH,QAAQ,GAAG,IAAI,CAAChJ,cAAc,GAAG,IAAI,CAACD,QAAQ;IACpD,MAAMkJ,QAAQ,GAAGxH,KAAK,CAACzB,cAAc,GAAGyB,KAAK,CAAC1B,QAAQ;IACtD,OAAOiJ,QAAQ,IAAIC,QAAQ,IAAI,IAAI,CAAC5J,IAAI,CAACqC,MAAM,CAACD,KAAK,CAACpC,IAAI,CAAC;EAC7D;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE6J,wBAAwBA,CAACzH,KAAK,EAAE;IAC9B,MAAMgE,CAAC,GAAG,IAAI,CAACxB,cAAc,CAAC,CAAC,CAACyB,qBAAqB,CAAC,CAAC;IACvD,MAAMiD,QAAQ,GAAG,IAAI,CAACtJ,IAAI,CAAC8B,KAAK,CAAC,CAAC;IAClCwH,QAAQ,CAACC,YAAY,CAACnD,CAAC,EAAEkD,QAAQ,CAAC5E,YAAY,CAAC0B,CAAC,CAAC,GAAG,IAAI,CAACzF,cAAc,GACrE,IAAI,CAACD,QAAQ,CAAC;IAChB,MAAM8I,QAAQ,GAAGpH,KAAK,CAACpC,IAAI,CAAC8B,KAAK,CAAC,CAAC;IACnC0H,QAAQ,CAACD,YAAY,CAACnD,CAAC,EAAEoD,QAAQ,CAAC9E,YAAY,CAAC0B,CAAC,CAAC,GAAGhE,KAAK,CAACzB,cAAc,GACtEyB,KAAK,CAAC1B,QAAQ,CAAC;IACjB,OAAO4I,QAAQ,CAACjH,MAAM,CAACmH,QAAQ,CAAC;EAClC;;EAGA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACE5E,cAAcA,CAAA,EAAG;IACf,IAAI,CAACxF,UAAU,EACbA,UAAU,GAAGxB,OAAO,CAAC,iBAAiB,CAAC,CAACwB,UAAU;IACpD,OAAOA,UAAU,CAAC0K,WAAW,CAAC,CAAC;EACjC;AAEF,CAAC,CAAC;AAAAC,OAAA,CAAAzK,IAAA,GAAAA,IAAA"}